!function(t,e,i,n){"use strict";var s=function(){return{applyChanges:function(t){if(t.hasOwnProperty("collection")&&this.updateCollection(t.collection),!this.isDragging())if(t.hasOwnProperty("selected")){var e=t.selected,i=this.getSlidePosition(t.selected);Math.abs(i)>0||0===i&&this.isInTransition()?this.transition(i,function(){this.select(e)}):null===i?this.select(e):0===i&&t.hasOwnProperty("collection")&&!this.isInTransition()&&this.refresh()}else t.hasOwnProperty("collection")&&!this.isInTransition()&&this.refresh()}}},r=function(t){return{translateContainer:function(e,i){t.css(this.TRANSITION_PROP+"Duration",i).css(this.TRANSFORM_PROP,this.TRANSFORMS_3D?"translate3d("+e+", 0, 0)":"translate("+e+", 0)")},getContainerPosition:function(){var i=e.getComputedStyle(t[0],null);if(e.WebKitCSSMatrix){var n=new WebKitCSSMatrix("none"===i.webkitTransform?"":i.webkitTransform);return n.m41}var n=i[this.TRANSFORM_PROP].split(",");return+(n[12]||n[4])},getContainerWidth:function(){return t[0].getBoundingClientRect().width||t.prop("offsetWidth")}}},l=function(){function t(t){for(var e=0;e<t.length;e++)if(i.documentElement.style[t[e]]!==n)return t[e]}var s,r;return e.ontransitionend===n&&e.onwebkittransitionend!==n?(s="WebkitTransition",r="webkitTransitionEnd transitionend"):(s="transition",r="transitionend"),{TRANSITION_PROP:s,TRANSITIONEND_EVENT:r,TRANSFORM_PROP:t(["transform","webkitTransform","MozTransform","msTransform","OTransform"]),TRANSFORMS_3D:!!t(["perspective","webkitPerspective","MozPerspective","MsPerspective","OPerspective"])}},a=function(t){var e,i;return{select:function(t,e){this.render(this.resolve(t)),this.move(e||0)},refresh:function(t){this.render(this.resolve()),this.move(t||0)},move:function(t){this.translate(t,0)},transition:function(t,e){this.translate(t,250,e)},isInTransition:function(){return i},translate:function(n,s,r){s>0?(e=r,i=!0):(e=null,i=!1),this.translateSlides(n,s),t&&t(this.index,n,s)},onTransitionEnd:function(){i=!1,e&&e.call(this),e=null}}},o=function(t){var e=[];return{render:function(i){if(i){for(var n=e.length-1;n>=0;n--){var s=e[n];this.collection.indexOf(s.item)===-1&&(s.destroy(),e.splice(n,1))}for(var n=0;n<this.collection.length;n++){for(var s=null,r=this.collection[n],l=e.length-1;l>=0;l--)e[l].item===r&&(s=e[l]);s||(s=t(r),s.element.css({position:"absolute",width:"100%",height:"100%"}),e.push(s)),s.element.css(this.TRANSFORM_PROP,"translate("+100*n+"%, 0)")}}},translateSlides:function(t,e){this.translateContainer(100*(-t-this.index)+"%",e+"ms")},getSlidesPosition:function(){return-this.getContainerPosition()/this.getContainerWidth()-this.index},getSlidePosition:function(t){if(null===this.index)return null;var e=this.collection.indexOf(t);return e===-1?null:e-this.index}}},c=function(t){var e=[];return{render:function(){function i(i,n){for(var s,r=e.length-1;r>=0;r--)e[r].item===n&&(s=e[r]);s||(s=t(n),s.element.css({position:"absolute",width:"100%",height:"100%"}),e.push(s)),s.element.css(this.TRANSFORM_PROP,"translate("+100*i+"%, 0)")}for(var n=e.length-1;n>=0;n--)null===this.getSlidePosition(e[n].item)&&(e[n].destroy(),e.splice(n,1));this.slides.left&&i.call(this,-1,this.slides.left.item),this.slides.center&&i.call(this,0,this.slides.center.item),this.slides.right&&i.call(this,1,this.slides.right.item)},translateSlides:function(t,e){this.translateContainer(100*-t+"%",e+"ms")},getSlidePosition:function(t){return this.slides.left&&this.slides.left.item===t?-1:this.slides.center&&this.slides.center.item===t?0:this.slides.right&&this.slides.right.item===t?1:null},getSlidesPosition:function(){return-this.getContainerPosition()/this.getContainerWidth()}}},u=function(t){var e=null;return{slides:{left:null,center:null,right:null},collection:[],resolve:function(i){var n=!1;if(e){this.collection=[];for(var s=0,r=e.length;s<r;s++)this.collection[s]=e[s];e=null,n=!0}var l=this.slides,a=this.collection;if(arguments.length?l.center={item:i}:!l.center&&a.length&&(l.center={item:a[0]}),l.center&&a.indexOf(l.center.item)===-1&&(l.center=a.length?{item:a[0]}:null),l.center){var o=this.index=a.indexOf(l.center.item);l.left=o>0?{item:a[o-1]}:null,l.right=a.length>o+1?{item:a[o+1]}:null}else l.left=l.right=null,this.index=null;return l.center&&t&&t(l.center.item),n},updateCollection:function(t){e=t}}},h=function(){var t,e,i,s,r,l=!1;return{onTouchStart:function(a){if(t=0,l=!0,s=n,r=this.getContainerWidth(),this.isInTransition()){t=this.getSlidesPosition();var o;t<-.5?(o=this.slides.left.item,t+=1):t>.5?(o=this.slides.right.item,t-=1):o=this.slides.center.item,this.select(o,t),s=!1}var c=a.touches||a.originalEvent.touches,u=c[0];e={x:u.pageX,y:u.pageY,time:a.timeStamp||+new Date},i={x:0,y:0}},onTouchMove:function(a){var o=a.touches||a.originalEvent.touches;if(!(o.length>1||a.scale&&1!==a.scale)){var c=o[0];if(i={x:c.pageX-e.x,y:c.pageY-e.y},s===n&&(s=!!(Math.abs(i.y)>Math.abs(i.x))),s)return void(l=!1);var u=-i.x/r+t;u=u>1?1:u<-1?-1:u;var h=1;(u<0&&!this.slides.left||u>0&&!this.slides.right)&&(h=1/Math.sqrt(Math.abs(u*r))),this.move(u*h)}},onTouchEnd:function(n){if(s)return void(l=!1);var a,o,c=-i.x/r+t,u=Math.abs(c)>.5||(n.timeStamp||+new Date)-e.time<250&&Math.abs(i.x)>20;u&&c<0&&this.slides.left?(a=this.slides.left.item,o=c<=-1?null:-1):u&&c>0&&this.slides.right?(a=this.slides.right.item,o=c>=1?null:1):Math.abs(c)>0?(a=this.slides.center.item,o=0):(a=this.slides.center.item,o=null),null!==o?this.transition(o,function(){this.select(a)}):this.select(a),l=!1},isDragging:function(){return l}}};t.module("swiperRepeat",["ng"]).directive("swiperRepeat",["$parse",function(e){var i={preventDefault:!0,stopPropagation:!1,prerender:!1,retranslator:null,disableTouch:!1};return{restrict:"A",transclude:"element",priority:1e3,terminal:!0,link:function(n,d,p,m,f){function g(t){var e=n.$new();e[_]=t;var i=f(e,function(t){N.append(t)});return E=!0,{element:i,item:t,destroy:function(){e.$destroy(),i.remove(),E=!0}}}function v(t){y&&y(n,t),E=!0}function x(t,e){E=!1,t.apply(C,e),E&&(n.$digest(),E=!1)}function w(t){return function(e){O.preventDefault&&e.preventDefault(),O.stopPropagation&&e.stopPropagation(),x(t,arguments)}}function S(){A||(n.$evalAsync(function(){C.applyChanges(k),A=!1,k={}}),A=!0)}var T=p.swiperRepeat||"",P=T.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)\s*$/),R=p.swiperRepeatSelected?p.swiperRepeatSelected:null,y=R?e(R).assign:null,b=p.swiperRepeatOptions?e(p.swiperRepeatOptions):null,O=t.copy(i);if(b&&t.extend(O,b(n)),!P)throw new Error("Expected expression in form of '_item_ in _collection_' but got "+T+".");var _=P[1],M=P[2],C={},E=!1,N=t.element('<div style="position:relative;width:100%;height:100%;"></div>');d.after(N),t.extend(C,l(),r(N),a(O.retranslator),u(v),h(),s(),O.prerender?o(g):c(g)),O.disableTouch||(N.on("touchstart",w(C.onTouchStart)),N.on("touchmove",w(C.onTouchMove)),N.on("touchend",w(C.onTouchEnd))),N.on(C.TRANSITIONEND_EVENT,function(t){t.target===N[0]&&(t.stopPropagation(),x(C.onTransitionEnd,arguments))});var k={},A=!1;n.$watchCollection(M,function(t){k.collection=t,S()}),R&&n.$watch(R,function(t){k.selected=t,S()})}}}])}(angular,window,document),angular.module("alpacaViewer",["alpacaTemplates","swiperRepeat"]),angular.module("alpacaViewer").directive("alpacaViewer",function(){return{restrict:"E",templateUrl:"alpaca-template-index",scope:{survey:"=",selected:"="}}}),angular.module("alpacaViewer").directive("alpacaSlides",["$compile",function(t){return{restrict:"E",replace:!0,template:"<div style='width:100%'><alpaca-slide slide='selected'/></div>"}}]),angular.module("alpacaViewer").directive("alpacaSlide",["$compile","$templateRequest",function(t,e){var i=function(i,n,s){i.linked||(i.linked=!0,i.slide||(i.slide={},i.slide.template=i.template,angular.forEach(i.schema,function(t){i.slide[t.key]=t.placeholder||"text"})),i.$watch("slide.template",function(){e("alpaca-template-"+i.slide.template).then(function(e){var s=angular.element(e);n.html(s),t(s)(i)})}))};return{restrict:"E",link:i,replace:!0,scope:{slide:"=?",template:"=?",schema:"=?"}}}]),angular.module("alpacaViewer").controller("alpacaViewerController",["$scope",function(t){t.survey={slides:[{id:1,title:"Slide 1",template:"green"},{id:2,title:"Slide 2",template:"orange"},{id:3,question:"Multiple choice with image",template:"multiplechoice",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}],image_align:"Left",image_url:"https://dummyimage.com/600x400/ffffff/00bcd4.jpg&text=img.",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{id:4,question:"Multiple choice without image",template:"multiplechoice_sans_image",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}],content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse nibh eros, placerat a vulputate quis, faucibus quis risus."},{id:5,question:"Likert with image",template:"likert",options:[{text:"strongly agree"},{text:"agree"},{text:"neutral"},{text:"disagree"},{text:"strongly disagree"}],image_align:"Left",image_url:"https://dummyimage.com/600x400/ffffff/00bcd4.jpg&text=img.",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit."},{id:6,question:"Likert without image",template:"likert_sans_image",options:[{text:"strongly agree"},{text:"agree"},{text:"neutral"},{text:"disagree"},{text:"strongly disagree"}],content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse nibh eros, placerat a vulputate quis, faucibus quis risus."},{id:7,question:"Testing Just Plain image",template:"image",image_align:"Top",image_url:"https://dummyimage.com/600x400/ffffff/00bcd4.jpg&text=img.",content:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse nibh eros, placerat a vulputate quis, faucibus quis risus."}]},t.selected=t.survey.slides[1]}]);
//# sourceMappingURL=alpaca-viewer.min.js.map
