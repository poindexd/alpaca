!function(e,t,i,n){"use strict";var s=function(){return{applyChanges:function(e){if(e.hasOwnProperty("collection")&&this.updateCollection(e.collection),!this.isDragging())if(e.hasOwnProperty("selected")){var t=e.selected,i=this.getSlidePosition(e.selected);Math.abs(i)>0||0===i&&this.isInTransition()?this.transition(i,function(){this.select(t)}):null===i?this.select(t):0===i&&e.hasOwnProperty("collection")&&!this.isInTransition()&&this.refresh()}else e.hasOwnProperty("collection")&&!this.isInTransition()&&this.refresh()}}},o=function(e){return{translateContainer:function(t,i){e.css(this.TRANSITION_PROP+"Duration",i).css(this.TRANSFORM_PROP,this.TRANSFORMS_3D?"translate3d("+t+", 0, 0)":"translate("+t+", 0)")},getContainerPosition:function(){var i=t.getComputedStyle(e[0],null);if(t.WebKitCSSMatrix){var n=new WebKitCSSMatrix("none"===i.webkitTransform?"":i.webkitTransform);return n.m41}var n=i[this.TRANSFORM_PROP].split(",");return+(n[12]||n[4])},getContainerWidth:function(){return e[0].getBoundingClientRect().width||e.prop("offsetWidth")}}},l=function(){function e(e){for(var t=0;t<e.length;t++)if(i.documentElement.style[e[t]]!==n)return e[t]}var s,o;return t.ontransitionend===n&&t.onwebkittransitionend!==n?(s="WebkitTransition",o="webkitTransitionEnd transitionend"):(s="transition",o="transitionend"),{TRANSITION_PROP:s,TRANSITIONEND_EVENT:o,TRANSFORM_PROP:e(["transform","webkitTransform","MozTransform","msTransform","OTransform"]),TRANSFORMS_3D:!!e(["perspective","webkitPerspective","MozPerspective","MsPerspective","OPerspective"])}},r=function(e){var t,i;return{select:function(e,t){this.render(this.resolve(e)),this.move(t||0)},refresh:function(e){this.render(this.resolve()),this.move(e||0)},move:function(e){this.translate(e,0)},transition:function(e,t){this.translate(e,250,t)},isInTransition:function(){return i},translate:function(n,s,o){s>0?(t=o,i=!0):(t=null,i=!1),this.translateSlides(n,s),e&&e(this.index,n,s)},onTransitionEnd:function(){i=!1,t&&t.call(this),t=null}}},a=function(e){var t=[];return{render:function(i){if(i){for(var n=t.length-1;n>=0;n--){var s=t[n];this.collection.indexOf(s.item)===-1&&(s.destroy(),t.splice(n,1))}for(var n=0;n<this.collection.length;n++){for(var s=null,o=this.collection[n],l=t.length-1;l>=0;l--)t[l].item===o&&(s=t[l]);s||(s=e(o),s.element.css({position:"absolute",width:"100%",height:"100%"}),t.push(s)),s.element.css(this.TRANSFORM_PROP,"translate("+100*n+"%, 0)")}}},translateSlides:function(e,t){this.translateContainer(100*(-e-this.index)+"%",t+"ms")},getSlidesPosition:function(){return-this.getContainerPosition()/this.getContainerWidth()-this.index},getSlidePosition:function(e){if(null===this.index)return null;var t=this.collection.indexOf(e);return t===-1?null:t-this.index}}},c=function(e){var t=[];return{render:function(){function i(i,n){for(var s,o=t.length-1;o>=0;o--)t[o].item===n&&(s=t[o]);s||(s=e(n),s.element.css({position:"absolute",width:"100%",height:"100%"}),t.push(s)),s.element.css(this.TRANSFORM_PROP,"translate("+100*i+"%, 0)")}for(var n=t.length-1;n>=0;n--)null===this.getSlidePosition(t[n].item)&&(t[n].destroy(),t.splice(n,1));this.slides.left&&i.call(this,-1,this.slides.left.item),this.slides.center&&i.call(this,0,this.slides.center.item),this.slides.right&&i.call(this,1,this.slides.right.item)},translateSlides:function(e,t){this.translateContainer(100*-e+"%",t+"ms")},getSlidePosition:function(e){return this.slides.left&&this.slides.left.item===e?-1:this.slides.center&&this.slides.center.item===e?0:this.slides.right&&this.slides.right.item===e?1:null},getSlidesPosition:function(){return-this.getContainerPosition()/this.getContainerWidth()}}},u=function(e){var t=null;return{slides:{left:null,center:null,right:null},collection:[],resolve:function(i){var n=!1;if(t){this.collection=[];for(var s=0,o=t.length;s<o;s++)this.collection[s]=t[s];t=null,n=!0}var l=this.slides,r=this.collection;if(arguments.length?l.center={item:i}:!l.center&&r.length&&(l.center={item:r[0]}),l.center&&r.indexOf(l.center.item)===-1&&(l.center=r.length?{item:r[0]}:null),l.center){var a=this.index=r.indexOf(l.center.item);l.left=a>0?{item:r[a-1]}:null,l.right=r.length>a+1?{item:r[a+1]}:null}else l.left=l.right=null,this.index=null;return l.center&&e&&e(l.center.item),n},updateCollection:function(e){t=e}}},d=function(){var e,t,i,s,o,l=!1;return{onTouchStart:function(r){if(e=0,l=!0,s=n,o=this.getContainerWidth(),this.isInTransition()){e=this.getSlidesPosition();var a;e<-.5?(a=this.slides.left.item,e+=1):e>.5?(a=this.slides.right.item,e-=1):a=this.slides.center.item,this.select(a,e),s=!1}var c=r.touches||r.originalEvent.touches,u=c[0];t={x:u.pageX,y:u.pageY,time:r.timeStamp||+new Date},i={x:0,y:0}},onTouchMove:function(r){var a=r.touches||r.originalEvent.touches;if(!(a.length>1||r.scale&&1!==r.scale)){var c=a[0];if(i={x:c.pageX-t.x,y:c.pageY-t.y},s===n&&(s=!!(Math.abs(i.y)>Math.abs(i.x))),s)return void(l=!1);var u=-i.x/o+e;u=u>1?1:u<-1?-1:u;var d=1;(u<0&&!this.slides.left||u>0&&!this.slides.right)&&(d=1/Math.sqrt(Math.abs(u*o))),this.move(u*d)}},onTouchEnd:function(n){if(s)return void(l=!1);var r,a,c=-i.x/o+e,u=Math.abs(c)>.5||(n.timeStamp||+new Date)-t.time<250&&Math.abs(i.x)>20;u&&c<0&&this.slides.left?(r=this.slides.left.item,a=c<=-1?null:-1):u&&c>0&&this.slides.right?(r=this.slides.right.item,a=c>=1?null:1):Math.abs(c)>0?(r=this.slides.center.item,a=0):(r=this.slides.center.item,a=null),null!==a?this.transition(a,function(){this.select(r)}):this.select(r),l=!1},isDragging:function(){return l}}};e.module("swiperRepeat",["ng"]).directive("swiperRepeat",["$parse",function(t){var i={preventDefault:!0,stopPropagation:!1,prerender:!1,retranslator:null,disableTouch:!1};return{restrict:"A",transclude:"element",priority:1e3,terminal:!0,link:function(n,h,m,p,g){function f(e){var t=n.$new();t[O]=e;var i=g(t,function(e){M.append(e)});return b=!0,{element:i,item:e,destroy:function(){t.$destroy(),i.remove(),b=!0}}}function v(e){P&&P(n,e),b=!0}function x(e,t){b=!1,e.apply(E,t),b&&(n.$digest(),b=!1)}function w(e){return function(t){y.preventDefault&&t.preventDefault(),y.stopPropagation&&t.stopPropagation(),x(e,arguments)}}function _(){D||(n.$evalAsync(function(){E.applyChanges(N),D=!1,N={}}),D=!0)}var T=m.swiperRepeat||"",A=T.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)\s*$/),S=m.swiperRepeatSelected?m.swiperRepeatSelected:null,P=S?t(S).assign:null,R=m.swiperRepeatOptions?t(m.swiperRepeatOptions):null,y=e.copy(i);if(R&&e.extend(y,R(n)),!A)throw new Error("Expected expression in form of '_item_ in _collection_' but got "+T+".");var O=A[1],C=A[2],E={},b=!1,M=e.element('<div style="position:relative;width:100%;height:100%;"></div>');h.after(M),e.extend(E,l(),o(M),r(y.retranslator),u(v),d(),s(),y.prerender?a(f):c(f)),y.disableTouch||(M.on("touchstart",w(E.onTouchStart)),M.on("touchmove",w(E.onTouchMove)),M.on("touchend",w(E.onTouchEnd))),M.on(E.TRANSITIONEND_EVENT,function(e){e.target===M[0]&&(e.stopPropagation(),x(E.onTransitionEnd,arguments))});var N={},D=!1;n.$watchCollection(C,function(e){N.collection=e,_()}),S&&n.$watch(S,function(e){N.selected=e,_()})}}}])}(angular,window,document),angular.module("alpacaViewer",["alpacaTemplates","swiperRepeat"]),angular.module("alpacaViewer").directive("alpacaViewer",function(){return{restrict:"E",templateUrl:"alpaca-template-index",scope:{slides:"=",selected:"="}}}),angular.module("alpacaViewer").directive("alpacaSlides",["$compile",function(e){var t=function(t,i,n){var s={};Array.isArray(t.slides)?(s=angular.element("<div swiper-repeat='slide in slides' swiper-repeat-selected='selected' disable-touch='true'><alpaca-slide slide='slide'/></div>"),i.append(s)):(s=angular.element("<div style='width:100%'><alpaca-slide slide='selected' single='true'/></div>"),i.html(s)),e(s)(t)};return{restrict:"E",replace:!0,link:t}}]),angular.module("alpacaViewer").directive("alpacaSlide",["$compile","$templateRequest",function(e,t){var i=function(i,n,s){!i.slide,i.$watch("slide.template",function(){return i.slide?void t("alpaca-template-"+i.slide.template).then(function(t){var s=angular.element(t);i.single?n.html(s):n.append(s),e(s)(i)}).catch(function(e){}):(console.error("slide is undefined"),!1)})};return{restrict:"E",link:i,scope:{slide:"=?",template:"=?",schema:"=?",single:"=?"}}}]),angular.module("alpacaViewer").controller("alpacaViewerController",["$scope",function(e){e.survey={slides:[{id:2,template:"likert_image_left",image:"/img/image-placeholder_grey.svg",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. ",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}]},{id:3,template:"likert_image_none",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. ",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}]},{id:4,template:"likert_image_right",image:"/img/image-placeholder_grey.svg",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. ",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}]},{id:5,template:"multiple_choice_image_left",image:"/img/image-placeholder_grey.svg",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. ",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}]},{id:6,template:"multiple_choice_image_none",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. ",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}]},{id:7,template:"multiple_choice_image_right",image:"/img/image-placeholder_grey.svg",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. ",options:[{text:"A"},{text:"B"},{text:"C"},{text:"D"},{text:"E"}]},{id:8,template:"text_image_left",image:"/img/image-placeholder_grey.svg",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. "},{id:9,template:"text_image_none",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. "},{id:10,template:"text_image_right",image:"/img/image-placeholder_grey.svg",content:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. "}]},e.selected=e.survey.slides[0]}]);
//# sourceMappingURL=alpaca-viewer.min.js.map
