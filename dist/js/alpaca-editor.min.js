!function(t){function e(t,e){return"all"==e?t:t.filter(function(t){return e.toLowerCase().indexOf(t)!=-1})}var i="application/x-dnd",n="application/json",s="Text",o=["move","copy","link"];t.directive("dndDraggable",["$parse","$timeout",function(t,r){return function(l,h,u){h.attr("draggable","true"),u.dndDisableIf&&l.$watch(u.dndDisableIf,function(t){h.attr("draggable",!t)}),h.on("dragstart",function(c){if(c=c.originalEvent||c,"false"==h.attr("draggable"))return!0;a.isDragging=!0,a.itemType=u.dndType&&l.$eval(u.dndType).toLowerCase(),a.dropEffect="none",a.effectAllowed=u.dndEffectAllowed||o[0],c.dataTransfer.effectAllowed=a.effectAllowed;var d=l.$eval(u.dndDraggable),p=i+(a.itemType?"-"+a.itemType:"");try{c.dataTransfer.setData(p,angular.toJson(d))}catch(t){var g=angular.toJson({item:d,type:a.itemType});try{c.dataTransfer.setData(n,g)}catch(t){var f=e(o,a.effectAllowed);c.dataTransfer.effectAllowed=f[0],c.dataTransfer.setData(s,g)}}if(h.addClass("dndDragging"),r(function(){h.addClass("dndDraggingSource")},0),c._dndHandle&&c.dataTransfer.setDragImage&&c.dataTransfer.setDragImage(h[0],0,0),t(u.dndDragstart)(l,{event:c}),u.dndCallback){var m=t(u.dndCallback);a.callback=function(t){return m(l,t||{})}}c.stopPropagation()}),h.on("dragend",function(e){e=e.originalEvent||e,l.$apply(function(){var i=a.dropEffect,n={copy:"dndCopied",link:"dndLinked",move:"dndMoved",none:"dndCanceled"};t(u[n[i]])(l,{event:e}),t(u.dndDragend)(l,{event:e,dropEffect:i})}),a.isDragging=!1,a.callback=void 0,h.removeClass("dndDragging"),h.removeClass("dndDraggingSource"),e.stopPropagation(),r(function(){h.removeClass("dndDraggingSource")},0)}),h.on("click",function(e){u.dndSelected&&(e=e.originalEvent||e,l.$apply(function(){t(u.dndSelected)(l,{event:e})}),e.stopPropagation())}),h.on("selectstart",function(){this.dragDrop&&this.dragDrop()})}}]),t.directive("dndList",["$parse",function(t){return function(r,l,h){function u(t){if(!t)return s;for(var e=0;e<t.length;e++)if(t[e]==s||t[e]==n||t[e].substr(0,i.length)==i)return t[e];return null}function c(t){return a.isDragging?a.itemType||void 0:t==s||t==n?null:t&&t.substr(i.length+1)||void 0}function d(t){return!x.disabled&&(!(!x.externalSources&&!a.isDragging)&&(!x.allowedTypes||null===t||t&&x.allowedTypes.indexOf(t)!=-1))}function p(t,i){var n=o;return i||(n=e(n,t.dataTransfer.effectAllowed)),a.isDragging&&(n=e(n,a.effectAllowed)),h.dndEffectAllowed&&(n=e(n,h.dndEffectAllowed)),n.length?t.ctrlKey&&n.indexOf("copy")!=-1?"copy":t.altKey&&n.indexOf("link")!=-1?"link":n[0]:"none"}function g(){return b.remove(),l.removeClass("dndDragover"),!0}function f(e,i,n,s,o,l){return t(e)(r,{callback:a.callback,dropEffect:n,event:i,external:!a.isDragging,index:void 0!==o?o:m(),item:l||void 0,type:s})}function m(){return Array.prototype.indexOf.call(y.children,w)}function v(){var t;return angular.forEach(l.children(),function(e){var i=angular.element(e);i.hasClass("dndPlaceholder")&&(t=i)}),t||angular.element("<li class='dndPlaceholder'></li>")}var b=v();b.remove();var w=b[0],y=l[0],x={};l.on("dragenter",function(t){t=t.originalEvent||t;var e=h.dndAllowedTypes&&r.$eval(h.dndAllowedTypes);x={allowedTypes:angular.isArray(e)&&e.join("|").toLowerCase().split("|"),disabled:h.dndDisableIf&&r.$eval(h.dndDisableIf),externalSources:h.dndExternalSources&&r.$eval(h.dndExternalSources),horizontal:h.dndHorizontalList&&r.$eval(h.dndHorizontalList)};var i=u(t.dataTransfer.types);return!i||!d(c(i))||void t.preventDefault()}),l.on("dragover",function(t){t=t.originalEvent||t;var e=u(t.dataTransfer.types),i=c(e);if(!e||!d(i))return!0;if(w.parentNode!=y&&l.append(b),t.target!=y){for(var n=t.target;n.parentNode!=y&&n.parentNode;)n=n.parentNode;if(n.parentNode==y&&n!=w){var o=n.getBoundingClientRect();if(x.horizontal)var a=t.clientX<o.left+o.width/2;else var a=t.clientY<o.top+o.height/2;y.insertBefore(w,a?n:n.nextSibling)}}var r=e==s,m=p(t,r);return"none"==m?g():h.dndDragover&&!f(h.dndDragover,t,m,i)?g():(t.preventDefault(),r||(t.dataTransfer.dropEffect=m),l.addClass("dndDragover"),t.stopPropagation(),!1)}),l.on("drop",function(t){t=t.originalEvent||t;var e=u(t.dataTransfer.types),i=c(e);if(!e||!d(i))return!0;t.preventDefault();try{var o=JSON.parse(t.dataTransfer.getData(e))}catch(t){return g()}if((e==s||e==n)&&(i=o.type||void 0,o=o.item,!d(i)))return g();var l=e==s,v=p(t,l);if("none"==v)return g();var b=m();return h.dndDrop&&(o=f(h.dndDrop,t,v,i,b,o),!o)?g():(a.dropEffect=v,l||(t.dataTransfer.dropEffect=v),o!==!0&&r.$apply(function(){r.$eval(h.dndList).splice(b,0,o)}),f(h.dndInserted,t,v,i,b,o),g(),t.stopPropagation(),!1)}),l.on("dragleave",function(t){t=t.originalEvent||t;var e=document.elementFromPoint(t.clientX,t.clientY);y.contains(e)&&!t._dndPhShown?t._dndPhShown=!0:g()})}}]),t.directive("dndNodrag",function(){return function(t,e,i){e.attr("draggable","true"),e.on("dragstart",function(t){t=t.originalEvent||t,t._dndHandle||(t.dataTransfer.types&&t.dataTransfer.types.length||t.preventDefault(),t.stopPropagation())}),e.on("dragend",function(t){t=t.originalEvent||t,t._dndHandle||t.stopPropagation()})}}),t.directive("dndHandle",function(){return function(t,e,i){e.attr("draggable","true"),e.on("dragstart dragend",function(t){t=t.originalEvent||t,t._dndHandle=!0})}});var a={}}(angular.module("dndLists",[])),function(t,e,i){"use strict";function n(e){if(this.support=!("undefined"==typeof File||"undefined"==typeof Blob||"undefined"==typeof FileList||!Blob.prototype.slice&&!Blob.prototype.webkitSlice&&!Blob.prototype.mozSlice),this.support){this.supportDirectory=/Chrome/.test(t.navigator.userAgent),this.files=[],this.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,singleFile:!1,fileParameterName:"file",progressCallbacksInterval:500,speedSmoothingFactor:.1,query:{},headers:{},withCredentials:!1,preprocess:null,method:"multipart",testMethod:"GET",uploadMethod:"POST",prioritizeFirstAndLastChunk:!1,allowDuplicateUploads:!1,target:"/",testChunks:!0,generateUniqueIdentifier:null,maxChunkRetries:0,chunkRetryInterval:null,permanentErrors:[404,413,415,500,501],successStatuses:[200,201,202],onDropStopPropagation:!1,initFileFn:null,readFileFn:o},this.opts={},this.events={};var i=this;this.onDrop=function(t){i.opts.onDropStopPropagation&&t.stopPropagation(),t.preventDefault();var e=t.dataTransfer;e.items&&e.items[0]&&e.items[0].webkitGetAsEntry?i.webkitReadDataTransfer(t):i.addFiles(e.files,t)},this.preventEvent=function(t){t.preventDefault()},this.opts=n.extend({},this.defaults,e||{})}}function s(t,e){this.flowObj=t,this.bytes=null,this.file=e,this.name=e.fileName||e.name,this.size=e.size,this.relativePath=e.relativePath||e.webkitRelativePath||this.name,this.uniqueIdentifier=t.generateUniqueIdentifier(e),this.chunks=[],this.paused=!1,this.error=!1,this.averageSpeed=0,this.currentSpeed=0,this._lastProgressCallback=Date.now(),this._prevUploadedSize=0,this._prevProgress=0,this.bootstrap()}function o(t,e,i,n,s){var o="slice";t.file.slice?o="slice":t.file.mozSlice?o="mozSlice":t.file.webkitSlice&&(o="webkitSlice"),s.readFinished(t.file[o](e,i,n))}function a(t,e,i){this.flowObj=t,this.fileObj=e,this.offset=i,this.tested=!1,this.retries=0,this.pendingRetry=!1,this.preprocessState=0,this.readState=0,this.loaded=0,this.total=0,this.chunkSize=this.flowObj.opts.chunkSize,this.startByte=this.offset*this.chunkSize,this.computeEndByte=function(){var t=Math.min(this.fileObj.size,(this.offset+1)*this.chunkSize);return this.fileObj.size-t<this.chunkSize&&!this.flowObj.opts.forceChunkSize&&(t=this.fileObj.size),t},this.endByte=this.computeEndByte(),this.xhr=null;var n=this;this.event=function(t,e){e=Array.prototype.slice.call(arguments),e.unshift(n),n.fileObj.chunkEvent.apply(n.fileObj,e)},this.progressHandler=function(t){t.lengthComputable&&(n.loaded=t.loaded,n.total=t.total),n.event("progress",t)},this.testHandler=function(t){var e=n.status(!0);"error"===e?(n.event(e,n.message()),n.flowObj.uploadNextChunk()):"success"===e?(n.tested=!0,n.event(e,n.message()),n.flowObj.uploadNextChunk()):n.fileObj.paused||(n.tested=!0,n.send())},this.doneHandler=function(t){var e=n.status();if("success"===e||"error"===e)delete this.data,n.event(e,n.message()),n.flowObj.uploadNextChunk();else{n.event("retry",n.message()),n.pendingRetry=!0,n.abort(),n.retries++;var i=n.flowObj.opts.chunkRetryInterval;null!==i?setTimeout(function(){n.send()},i):n.send()}}}function r(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}function l(t,e){return"function"==typeof t&&(e=Array.prototype.slice.call(arguments),t=t.apply(null,e.slice(1))),t}function h(t,e){setTimeout(t.bind(e),0)}function u(t,e){return c(arguments,function(e){e!==t&&c(e,function(e,i){t[i]=e})}),t}function c(t,e,i){if(t){var n;if("undefined"!=typeof t.length){for(n=0;n<t.length;n++)if(e.call(i,t[n],n)===!1)return}else for(n in t)if(t.hasOwnProperty(n)&&e.call(i,t[n],n)===!1)return}}var d=t.navigator.msPointerEnabled;n.prototype={on:function(t,e){t=t.toLowerCase(),this.events.hasOwnProperty(t)||(this.events[t]=[]),this.events[t].push(e)},off:function(t,e){t!==i?(t=t.toLowerCase(),e!==i?this.events.hasOwnProperty(t)&&r(this.events[t],e):delete this.events[t]):this.events={}},fire:function(t,e){e=Array.prototype.slice.call(arguments),t=t.toLowerCase();var i=!1;return this.events.hasOwnProperty(t)&&c(this.events[t],function(t){i=t.apply(this,e.slice(1))===!1||i},this),"catchall"!=t&&(e.unshift("catchAll"),i=this.fire.apply(this,e)===!1||i),!i},webkitReadDataTransfer:function(t){function e(t){t.readEntries(function(o){o.length?(a+=o.length,c(o,function(t){if(t.isFile){var s=t.fullPath;t.file(function(t){i(t,s)},n)}else t.isDirectory&&e(t.createReader())}),e(t)):s()},n)}function i(t,e){t.relativePath=e.substring(1),r.push(t),s()}function n(t){throw t}function s(){0==--a&&o.addFiles(r,t)}var o=this,a=t.dataTransfer.items.length,r=[];c(t.dataTransfer.items,function(t){var n=t.webkitGetAsEntry();return n?void(n.isFile?i(t.getAsFile(),n.fullPath):e(n.createReader())):void s()})},generateUniqueIdentifier:function(t){var e=this.opts.generateUniqueIdentifier;if("function"==typeof e)return e(t);var i=t.relativePath||t.webkitRelativePath||t.fileName||t.name;return t.size+"-"+i.replace(/[^0-9a-zA-Z_-]/gim,"")},uploadNextChunk:function(t){var e=!1;if(this.opts.prioritizeFirstAndLastChunk&&(c(this.files,function(t){return!t.paused&&t.chunks.length&&"pending"===t.chunks[0].status()?(t.chunks[0].send(),e=!0,!1):!t.paused&&t.chunks.length>1&&"pending"===t.chunks[t.chunks.length-1].status()?(t.chunks[t.chunks.length-1].send(),e=!0,!1):void 0}),e))return e;if(c(this.files,function(t){if(t.paused||c(t.chunks,function(t){if("pending"===t.status())return t.send(),e=!0,!1}),e)return!1}),e)return!0;var i=!1;return c(this.files,function(t){if(!t.isComplete())return i=!0,!1}),i||t||h(function(){this.fire("complete")},this),!1},assignBrowse:function(t,i,n,s){t instanceof Element&&(t=[t]),c(t,function(t){var o;"INPUT"===t.tagName&&"file"===t.type?o=t:(o=e.createElement("input"),o.setAttribute("type","file"),u(o.style,{visibility:"hidden",position:"absolute",width:"1px",height:"1px"}),t.appendChild(o),t.addEventListener("click",function(){o.click()},!1)),this.opts.singleFile||n||o.setAttribute("multiple","multiple"),i&&o.setAttribute("webkitdirectory","webkitdirectory"),c(s,function(t,e){o.setAttribute(e,t)});var a=this;o.addEventListener("change",function(t){t.target.value&&(a.addFiles(t.target.files,t),t.target.value="")},!1)},this)},assignDrop:function(t){"undefined"==typeof t.length&&(t=[t]),c(t,function(t){t.addEventListener("dragover",this.preventEvent,!1),t.addEventListener("dragenter",this.preventEvent,!1),t.addEventListener("drop",this.onDrop,!1)},this)},unAssignDrop:function(t){"undefined"==typeof t.length&&(t=[t]),c(t,function(t){t.removeEventListener("dragover",this.preventEvent),t.removeEventListener("dragenter",this.preventEvent),t.removeEventListener("drop",this.onDrop)},this)},isUploading:function(){var t=!1;return c(this.files,function(e){if(e.isUploading())return t=!0,!1}),t},_shouldUploadNext:function(){var t=0,e=!0,i=this.opts.simultaneousUploads;return c(this.files,function(n){c(n.chunks,function(n){if("uploading"===n.status()&&(t++,t>=i))return e=!1,!1})}),e&&t},upload:function(){var t=this._shouldUploadNext();if(t!==!1){this.fire("uploadStart");for(var e=!1,i=1;i<=this.opts.simultaneousUploads-t;i++)e=this.uploadNextChunk(!0)||e;e||h(function(){this.fire("complete")},this)}},resume:function(){c(this.files,function(t){t.resume()})},pause:function(){c(this.files,function(t){t.pause()})},cancel:function(){for(var t=this.files.length-1;t>=0;t--)this.files[t].cancel()},progress:function(){var t=0,e=0;return c(this.files,function(i){t+=i.progress()*i.size,e+=i.size}),e>0?t/e:0},addFile:function(t,e){this.addFiles([t],e)},addFiles:function(t,e){var i=[];c(t,function(t){if((!d||d&&t.size>0)&&(t.size%4096!==0||"."!==t.name&&"."!==t.fileName)&&(this.opts.allowDuplicateUploads||!this.getFromUniqueIdentifier(this.generateUniqueIdentifier(t)))){var n=new s(this,t);this.fire("fileAdded",n,e)&&i.push(n)}},this),this.fire("filesAdded",i,e)&&(c(i,function(t){this.opts.singleFile&&this.files.length>0&&this.removeFile(this.files[0]),this.files.push(t)},this),this.fire("filesSubmitted",i,e))},removeFile:function(t){for(var e=this.files.length-1;e>=0;e--)this.files[e]===t&&(this.files.splice(e,1),t.abort(),this.fire("fileRemoved",t))},getFromUniqueIdentifier:function(t){var e=!1;return c(this.files,function(i){i.uniqueIdentifier===t&&(e=i)}),e},getSize:function(){var t=0;return c(this.files,function(e){t+=e.size}),t},sizeUploaded:function(){var t=0;return c(this.files,function(e){t+=e.sizeUploaded()}),t},timeRemaining:function(){var t=0,e=0;return c(this.files,function(i){i.paused||i.error||(t+=i.size-i.sizeUploaded(),e+=i.averageSpeed)}),t&&!e?Number.POSITIVE_INFINITY:t||e?Math.floor(t/e):0}},s.prototype={measureSpeed:function(){var t=Date.now()-this._lastProgressCallback;if(t){var e=this.flowObj.opts.speedSmoothingFactor,i=this.sizeUploaded();this.currentSpeed=Math.max((i-this._prevUploadedSize)/t*1e3,0),this.averageSpeed=e*this.currentSpeed+(1-e)*this.averageSpeed,this._prevUploadedSize=i}},chunkEvent:function(t,e,i){switch(e){case"progress":if(Date.now()-this._lastProgressCallback<this.flowObj.opts.progressCallbacksInterval)break;this.measureSpeed(),this.flowObj.fire("fileProgress",this,t),this.flowObj.fire("progress"),this._lastProgressCallback=Date.now();break;case"error":this.error=!0,this.abort(!0),this.flowObj.fire("fileError",this,i,t),this.flowObj.fire("error",i,this,t);break;case"success":if(this.error)return;this.measureSpeed(),this.flowObj.fire("fileProgress",this,t),this.flowObj.fire("progress"),this._lastProgressCallback=Date.now(),this.isComplete()&&(this.currentSpeed=0,this.averageSpeed=0,this.flowObj.fire("fileSuccess",this,i,t));break;case"retry":this.flowObj.fire("fileRetry",this,t)}},pause:function(){this.paused=!0,this.abort()},resume:function(){this.paused=!1,this.flowObj.upload()},abort:function(t){this.currentSpeed=0,this.averageSpeed=0;var e=this.chunks;t&&(this.chunks=[]),c(e,function(t){"uploading"===t.status()&&(t.abort(),this.flowObj.uploadNextChunk())},this)},cancel:function(){this.flowObj.removeFile(this)},retry:function(){this.bootstrap(),this.flowObj.upload()},bootstrap:function(){"function"==typeof this.flowObj.opts.initFileFn&&this.flowObj.opts.initFileFn(this),this.abort(!0),this.error=!1,this._prevProgress=0;for(var t=this.flowObj.opts.forceChunkSize?Math.ceil:Math.floor,e=Math.max(t(this.size/this.flowObj.opts.chunkSize),1),i=0;i<e;i++)this.chunks.push(new a(this.flowObj,this,i))},progress:function(){if(this.error)return 1;if(1===this.chunks.length)return this._prevProgress=Math.max(this._prevProgress,this.chunks[0].progress()),this._prevProgress;var t=0;c(this.chunks,function(e){t+=e.progress()*(e.endByte-e.startByte)});var e=t/this.size;return this._prevProgress=Math.max(this._prevProgress,e>.9999?1:e),this._prevProgress},isUploading:function(){var t=!1;return c(this.chunks,function(e){if("uploading"===e.status())return t=!0,!1}),t},isComplete:function(){var t=!1;return c(this.chunks,function(e){var i=e.status();if("pending"===i||"uploading"===i||"reading"===i||1===e.preprocessState||1===e.readState)return t=!0,!1}),!t},sizeUploaded:function(){var t=0;return c(this.chunks,function(e){t+=e.sizeUploaded()}),t},timeRemaining:function(){if(this.paused||this.error)return 0;var t=this.size-this.sizeUploaded();return t&&!this.averageSpeed?Number.POSITIVE_INFINITY:t||this.averageSpeed?Math.floor(t/this.averageSpeed):0},getType:function(){return this.file.type&&this.file.type.split("/")[1]},getExtension:function(){return this.name.substr((~-this.name.lastIndexOf(".")>>>0)+2).toLowerCase()}},a.prototype={getParams:function(){return{flowChunkNumber:this.offset+1,flowChunkSize:this.flowObj.opts.chunkSize,flowCurrentChunkSize:this.endByte-this.startByte,flowTotalSize:this.fileObj.size,flowIdentifier:this.fileObj.uniqueIdentifier,flowFilename:this.fileObj.name,flowRelativePath:this.fileObj.relativePath,flowTotalChunks:this.fileObj.chunks.length}},getTarget:function(t,e){return t+=t.indexOf("?")<0?"?":"&",t+e.join("&")},test:function(){this.xhr=new XMLHttpRequest,this.xhr.addEventListener("load",this.testHandler,!1),this.xhr.addEventListener("error",this.testHandler,!1);var t=l(this.flowObj.opts.testMethod,this.fileObj,this),e=this.prepareXhrRequest(t,!0);this.xhr.send(e)},preprocessFinished:function(){this.endByte=this.computeEndByte(),this.preprocessState=2,this.send()},readFinished:function(t){this.readState=2,this.bytes=t,this.send()},send:function(){var t=this.flowObj.opts.preprocess,e=this.flowObj.opts.readFileFn;if("function"==typeof t)switch(this.preprocessState){case 0:return this.preprocessState=1,void t(this);case 1:return}switch(this.readState){case 0:return this.readState=1,void e(this.fileObj,this.startByte,this.endByte,this.fileObj.file.type,this);case 1:return}if(this.flowObj.opts.testChunks&&!this.tested)return void this.test();this.loaded=0,this.total=0,this.pendingRetry=!1,this.xhr=new XMLHttpRequest,this.xhr.upload.addEventListener("progress",this.progressHandler,!1),this.xhr.addEventListener("load",this.doneHandler,!1),this.xhr.addEventListener("error",this.doneHandler,!1);var i=l(this.flowObj.opts.uploadMethod,this.fileObj,this),n=this.prepareXhrRequest(i,!1,this.flowObj.opts.method,this.bytes);this.xhr.send(n)},abort:function(){var t=this.xhr;this.xhr=null,t&&t.abort()},status:function(t){return 1===this.readState?"reading":this.pendingRetry||1===this.preprocessState?"uploading":this.xhr?this.xhr.readyState<4?"uploading":this.flowObj.opts.successStatuses.indexOf(this.xhr.status)>-1?"success":this.flowObj.opts.permanentErrors.indexOf(this.xhr.status)>-1||!t&&this.retries>=this.flowObj.opts.maxChunkRetries?"error":(this.abort(),"pending"):"pending"},message:function(){return this.xhr?this.xhr.responseText:""},progress:function(){if(this.pendingRetry)return 0;var t=this.status();return"success"===t||"error"===t?1:"pending"===t?0:this.total>0?this.loaded/this.total:0},sizeUploaded:function(){var t=this.endByte-this.startByte;return"success"!==this.status()&&(t=this.progress()*t),t},prepareXhrRequest:function(t,e,i,n){var s=l(this.flowObj.opts.query,this.fileObj,this,e);s=u(s,this.getParams());var o=l(this.flowObj.opts.target,this.fileObj,this,e),a=null;if("GET"===t||"octet"===i){var r=[];c(s,function(t,e){r.push([encodeURIComponent(e),encodeURIComponent(t)].join("="))}),o=this.getTarget(o,r),a=n||null}else a=new FormData,c(s,function(t,e){a.append(e,t)}),a.append(this.flowObj.opts.fileParameterName,n,this.fileObj.file.name);return this.xhr.open(t,o,!0),this.xhr.withCredentials=this.flowObj.opts.withCredentials,c(l(this.flowObj.opts.headers,this.fileObj,this,e),function(t,e){this.xhr.setRequestHeader(e,t)},this),a}},n.evalOpts=l,n.extend=u,n.each=c,n.FlowFile=s,n.FlowChunk=a,n.version="2.11.2","object"==typeof module&&module&&"object"==typeof module.exports?module.exports=n:(t.Flow=n,"function"==typeof define&&define.amd&&define("flow",[],function(){return n}))}(window,document),angular.module("flow.provider",[]).provider("flowFactory",function(){"use strict";this.defaults={},this.factory=function(t){return new Flow(t)},this.events=[],this.on=function(t,e){this.events.push([t,e])},this.$get=function(){var t=this.factory,e=this.defaults,i=this.events;return{create:function(n){var s=t(angular.extend({},e,n));return angular.forEach(i,function(t){s.on(t[0],t[1])}),s}}}}),angular.module("flow.init",["flow.provider"]).controller("flowCtrl",["$scope","$attrs","$parse","flowFactory",function(t,e,i,n){var s=angular.extend({},t.$eval(e.flowInit)),o=t.$eval(e.flowObject)||n.create(s),a=function(e){var i=Array.prototype.slice.call(arguments);i.shift();var n=t.$broadcast.apply(t,["flow::"+e,o].concat(i));if({progress:1,filesSubmitted:1,fileSuccess:1,fileError:1,complete:1}[e]&&t.$apply(),n.defaultPrevented)return!1};o.on("catchAll",a),t.$on("$destroy",function(){o.off("catchAll",a)}),t.$flow=o,e.hasOwnProperty("flowName")&&(i(e.flowName).assign(t,o),t.$on("$destroy",function(){i(e.flowName).assign(t)}))}]).directive("flowInit",[function(){return{scope:!0,controller:"flowCtrl"}}]),angular.module("flow.btn",["flow.init"]).directive("flowBtn",[function(){return{restrict:"EA",scope:!1,require:"^flowInit",link:function(t,e,i){var n=i.hasOwnProperty("flowDirectory"),s=i.hasOwnProperty("flowSingleFile"),o=i.hasOwnProperty("flowAttrs")&&t.$eval(i.flowAttrs);t.$flow.assignBrowse(e,n,s,o)}}}]),angular.module("flow.dragEvents",["flow.init"]).directive("flowPreventDrop",function(){return{scope:!1,link:function(t,e,i){e.bind("drop dragover",function(t){t.preventDefault()})}}}).directive("flowDragEnter",["$timeout",function(t){return{scope:!1,link:function(e,i,n){function s(t){var e=!1,i=t.dataTransfer||t.originalEvent.dataTransfer;return angular.forEach(i&&i.types,function(t){"Files"===t&&(e=!0)}),e}var o,a=!1;i.bind("dragover",function(i){s(i)&&(a||(e.$apply(n.flowDragEnter),a=!0),t.cancel(o),i.preventDefault())}),i.bind("dragleave drop",function(i){t.cancel(o),o=t(function(){e.$eval(n.flowDragLeave),o=null,a=!1},100)})}}}]),angular.module("flow.drop",["flow.init"]).directive("flowDrop",function(){return{scope:!1,require:"^flowInit",link:function(t,e,i){function n(){t.$flow.assignDrop(e)}function s(){t.$flow.unAssignDrop(e)}i.flowDropEnabled?t.$watch(i.flowDropEnabled,function(t){t?n():s()}):n()}}}),!function(t){"use strict";function e(t){return t.charAt(0).toUpperCase()+t.slice(1)}var i=t.module("flow.events",["flow.init"]),n={fileSuccess:["$file","$message"],fileProgress:["$file"],fileAdded:["$file","$event"],filesAdded:["$files","$event"],filesSubmitted:["$files","$event"],fileRetry:["$file"],fileError:["$file","$message"],uploadStart:[],complete:[],progress:[],error:["$message","$file"]};t.forEach(n,function(n,s){var o="flow"+e(s);"flowUploadStart"==o&&(o="flowUploadStarted"),i.directive(o,[function(){return{require:"^flowInit",controller:["$scope","$attrs",function(e,i){e.$on("flow::"+s,function(){var s=Array.prototype.slice.call(arguments),a=s.shift();if(e.$flow===s.shift()){var r={};t.forEach(n,function(t,e){r[t]=s[e]}),e.$eval(i[o],r)===!1&&a.preventDefault()}})}]}}])})}(angular),angular.module("flow.img",["flow.init"]).directive("flowImg",[function(){return{scope:!1,require:"^flowInit",link:function(t,e,i){var n=i.flowImg;t.$watch(n,function(e){if(e){var n=new FileReader;n.readAsDataURL(e.file),n.onload=function(e){t.$apply(function(){i.$set("src",e.target.result)})}}})}}}]),angular.module("flow.transfers",["flow.init"]).directive("flowTransfers",[function(){return{scope:!0,require:"^flowInit",link:function(t){t.transfers=t.$flow.files}}}]),angular.module("flow",["flow.provider","flow.init","flow.events","flow.btn","flow.drop","flow.transfers","flow.img","flow.dragEvents"]),angular.module("angularResizable",[]).directive("resizable",function(){function t(t){void 0===e?(e=t,setTimeout(function(){e(),e=void 0},100)):e=t}var e;return{restrict:"AE",scope:{rDirections:"=",rCenteredX:"=",rCenteredY:"=",rWidth:"=",rHeight:"=",rFlex:"=",rGrabber:"@",rDisabled:"@",rNoThrottle:"="},link:function(e,i,n){var s="flexBasis"in document.documentElement.style?"flexBasis":"webkitFlexBasis"in document.documentElement.style?"webkitFlexBasis":"msFlexPreferredSize"in document.documentElement.style?"msFlexPreferredSize":"flexBasis";e.$watch("rWidth",function(t){i[0].style[e.rFlex?s:"width"]=e.rWidth+"px"}),e.$watch("rHeight",function(t){i[0].style[e.rFlex?s:"height"]=e.rHeight+"px"}),i.addClass("resizable");var o,a,r,l,h,u=window.getComputedStyle(i[0],null),c=e.rDirections||["right"],d=e.rCenteredX?2:1,p=e.rCenteredY?2:1,g=e.rGrabber?e.rGrabber:"<span></span>",f={},m=function(t){f.width=!1,f.height=!1,"x"===h?f.width=parseInt(i[0].style[e.rFlex?s:"width"]):f.height=parseInt(i[0].style[e.rFlex?s:"height"]),f.id=i[0].id,f.evt=t},v=function(t){return t.touches?t.touches[0].clientX:t.clientX},b=function(t){return t.touches?t.touches[0].clientY:t.clientY},w=function(n){function u(){e.$emit("angular-resizable.resizing",f)}var c,g="x"===h?r-v(n):r-b(n);switch(l){case"top":c=e.rFlex?s:"height",i[0].style[c]=a+g*p+"px";break;case"bottom":c=e.rFlex?s:"height",i[0].style[c]=a-g*p+"px";break;case"right":c=e.rFlex?s:"width",i[0].style[c]=o-g*d+"px";break;case"left":c=e.rFlex?s:"width",i[0].style[c]=o+g*d+"px"}m(n),e.rNoThrottle?u():t(u)},y=function(t){m(),e.$emit("angular-resizable.resizeEnd",f),e.$apply(),document.removeEventListener("mouseup",y,!1),document.removeEventListener("mousemove",w,!1),document.removeEventListener("touchend",y,!1),document.removeEventListener("touchmove",w,!1),i.removeClass("no-transition")},x=function(t,n){l=n,h="left"===l||"right"===l?"x":"y",r="x"===h?v(t):b(t),o=parseInt(u.getPropertyValue("width")),a=parseInt(u.getPropertyValue("height")),i.addClass("no-transition"),document.addEventListener("mouseup",y,!1),document.addEventListener("mousemove",w,!1),document.addEventListener("touchend",y,!1),document.addEventListener("touchmove",w,!1),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,m(t),e.$emit("angular-resizable.resizeStart",f),e.$apply()};c.forEach(function(t){var n=document.createElement("div");n.setAttribute("class","rg-"+t),n.innerHTML=g,i[0].appendChild(n),n.ondragstart=function(){return!1};var s=function(i){var n="true"===e.rDisabled;n||1!==i.which&&!i.touches||x(i,t)};n.addEventListener("mousedown",s,!1),n.addEventListener("touchstart",s,!1)})}}}),function(){"use strict";var t={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,left:37,right:39,delete:46,comma:188},e=9007199254740991,i=["text","email","url"],n=angular.module("ngTagsInput",[]);n.directive("tagsInput",["$timeout","$document","$window","$q","tagsInputConfig","tiUtil",function(n,s,o,a,r,l){function h(t,e,i,n){var s,o,r,h,u={};return s=function(e){return l.safeToString(e[t.displayProperty])},o=function(e,i){e[t.displayProperty]=i},r=function(e){var n=s(e),o=n&&n.length>=t.minLength&&n.length<=t.maxLength&&t.allowedTagsPattern.test(n)&&!l.findInObjectArray(u.items,e,t.keyProperty||t.displayProperty);return a.when(o&&i({$tag:e})).then(l.promisifyValue)},h=function(t){return a.when(n({$tag:t})).then(l.promisifyValue)},u.items=[],u.addText=function(t){var e={};return o(e,t),u.add(e)},u.add=function(i){var n=s(i);return t.replaceSpacesWithDashes&&(n=l.replaceSpacesWithDashes(n)),o(i,n),r(i).then(function(){u.items.push(i),e.trigger("tag-added",{$tag:i})}).catch(function(){n&&e.trigger("invalid-tag",{$tag:i})})},u.remove=function(t){var i=u.items[t];return h(i).then(function(){return u.items.splice(t,1),u.clearSelection(),e.trigger("tag-removed",{$tag:i}),i})},u.select=function(t){t<0?t=u.items.length-1:t>=u.items.length&&(t=0),u.index=t,u.selected=u.items[t]},u.selectPrior=function(){u.select(--u.index)},u.selectNext=function(){u.select(++u.index)},u.removeSelected=function(){return u.remove(u.index)},u.clearSelection=function(){u.selected=null,u.index=-1},u.clearSelection(),u}function u(t){return i.indexOf(t)!==-1}return{restrict:"E",require:"ngModel",scope:{tags:"=ngModel",text:"=?",templateScope:"=?",tagClass:"&",onTagAdding:"&",onTagAdded:"&",onInvalidTag:"&",onTagRemoving:"&",onTagRemoved:"&",onTagClicked:"&"},replace:!1,transclude:!0,templateUrl:"ngTagsInput/tags-input.html",controller:["$scope","$attrs","$element",function(t,i,n){t.events=l.simplePubSub(),r.load("tagsInput",t,i,{template:[String,"ngTagsInput/tag-item.html"],type:[String,"text",u],placeholder:[String,"Add a tag"],tabindex:[Number,null],removeTagSymbol:[String,String.fromCharCode(215)],replaceSpacesWithDashes:[Boolean,!0],minLength:[Number,3],maxLength:[Number,e],addOnEnter:[Boolean,!0],addOnSpace:[Boolean,!1],addOnComma:[Boolean,!0],addOnBlur:[Boolean,!0],addOnPaste:[Boolean,!1],pasteSplitPattern:[RegExp,/,/],allowedTagsPattern:[RegExp,/.+/],enableEditingLastTag:[Boolean,!1],minTags:[Number,0],maxTags:[Number,e],displayProperty:[String,"text"],keyProperty:[String,""],allowLeftoverText:[Boolean,!1],addFromAutocompleteOnly:[Boolean,!1],spellcheck:[Boolean,!0]}),t.tagList=new h(t.options,t.events,l.handleUndefinedResult(t.onTagAdding,!0),l.handleUndefinedResult(t.onTagRemoving,!0)),this.registerAutocomplete=function(){n.find("input");return{addTag:function(e){return t.tagList.add(e)},getTags:function(){return t.tagList.items},getCurrentTagText:function(){return t.newTag.text()},getOptions:function(){return t.options},getTemplateScope:function(){return t.templateScope},on:function(e,i){return t.events.on(e,i,!0),this}}},this.registerTagItem=function(){return{getOptions:function(){return t.options},removeTag:function(e){t.disabled||t.tagList.remove(e)}}}}],link:function(e,i,a,r){var h,u,c=[t.enter,t.comma,t.space,t.backspace,t.delete,t.left,t.right],d=e.tagList,p=e.events,g=e.options,f=i.find("input"),m=["minTags","maxTags","allowLeftoverText"];h=function(){r.$setValidity("maxTags",d.items.length<=g.maxTags),r.$setValidity("minTags",d.items.length>=g.minTags),r.$setValidity("leftoverText",!(!e.hasFocus&&!g.allowLeftoverText)||!e.newTag.text())},u=function(){n(function(){f[0].focus()})},r.$isEmpty=function(t){return!t||!t.length},e.newTag={text:function(t){return angular.isDefined(t)?(e.text=t,void p.trigger("input-change",t)):e.text||""},invalid:null},e.track=function(t){return t[g.keyProperty||g.displayProperty]},e.getTagClass=function(t,i){var n=t===d.selected;return[e.tagClass({$tag:t,$index:i,$selected:n}),{selected:n}]},e.$watch("tags",function(t){t?(d.items=l.makeObjectArray(t,g.displayProperty),e.tags=d.items):d.items=[]}),e.$watch("tags.length",function(){h(),r.$validate()}),a.$observe("disabled",function(t){e.disabled=t}),e.eventHandlers={input:{keydown:function(t){p.trigger("input-keydown",t)},focus:function(){e.hasFocus||(e.hasFocus=!0,p.trigger("input-focus"))},blur:function(){n(function(){var t=s.prop("activeElement"),n=t===f[0],o=i[0].contains(t);!n&&o||(e.hasFocus=!1,p.trigger("input-blur"))})},paste:function(t){t.getTextData=function(){var e=t.clipboardData||t.originalEvent&&t.originalEvent.clipboardData;return e?e.getData("text/plain"):o.clipboardData.getData("Text")},p.trigger("input-paste",t)}},host:{click:function(){e.disabled||u()}},tag:{click:function(t){p.trigger("tag-clicked",{$tag:t})}}},p.on("tag-added",e.onTagAdded).on("invalid-tag",e.onInvalidTag).on("tag-removed",e.onTagRemoved).on("tag-clicked",e.onTagClicked).on("tag-added",function(){e.newTag.text("")}).on("tag-added tag-removed",function(){e.tags=d.items,r.$setDirty(),u()}).on("invalid-tag",function(){e.newTag.invalid=!0}).on("option-change",function(t){m.indexOf(t.name)!==-1&&h()}).on("input-change",function(){d.clearSelection(),e.newTag.invalid=null}).on("input-focus",function(){i.triggerHandler("focus"),r.$setValidity("leftoverText",!0)}).on("input-blur",function(){g.addOnBlur&&!g.addFromAutocompleteOnly&&d.addText(e.newTag.text()),i.triggerHandler("blur"),h()}).on("input-keydown",function(i){var n,s,o,a,r=i.keyCode,h={};
l.isModifierOn(i)||c.indexOf(r)===-1||(h[t.enter]=g.addOnEnter,h[t.comma]=g.addOnComma,h[t.space]=g.addOnSpace,n=!g.addFromAutocompleteOnly&&h[r],s=(r===t.backspace||r===t.delete)&&d.selected,a=r===t.backspace&&0===e.newTag.text().length&&g.enableEditingLastTag,o=(r===t.backspace||r===t.left||r===t.right)&&0===e.newTag.text().length&&!g.enableEditingLastTag,n?d.addText(e.newTag.text()):a?(d.selectPrior(),d.removeSelected().then(function(t){t&&e.newTag.text(t[g.displayProperty])})):s?d.removeSelected():o&&(r===t.left||r===t.backspace?d.selectPrior():r===t.right&&d.selectNext()),(n||o||s||a)&&i.preventDefault())}).on("input-paste",function(t){if(g.addOnPaste){var e=t.getTextData(),i=e.split(g.pasteSplitPattern);i.length>1&&(i.forEach(function(t){d.addText(t)}),t.preventDefault())}})}}}]),n.directive("tiTagItem",["tiUtil",function(t){return{restrict:"E",require:"^tagsInput",template:'<ng-include src="$$template"></ng-include>',scope:{$scope:"=scope",data:"="},link:function(e,i,n,s){var o=s.registerTagItem(),a=o.getOptions();e.$$template=a.template,e.$$removeTagSymbol=a.removeTagSymbol,e.$getDisplayText=function(){return t.safeToString(e.data[a.displayProperty])},e.$removeTag=function(){o.removeTag(e.$index)},e.$watch("$parent.$index",function(t){e.$index=t})}}}]),n.directive("autoComplete",["$document","$timeout","$sce","$q","tagsInputConfig","tiUtil",function(e,i,n,s,o,a){function r(t,e,i){var n,o,r,l={};return r=function(){return e.tagsInput.keyProperty||e.tagsInput.displayProperty},n=function(t,i){return t.filter(function(t){return!a.findInObjectArray(i,t,r(),function(t,i){return e.tagsInput.replaceSpacesWithDashes&&(t=a.replaceSpacesWithDashes(t),i=a.replaceSpacesWithDashes(i)),a.defaultComparer(t,i)})})},l.reset=function(){o=null,l.items=[],l.visible=!1,l.index=-1,l.selected=null,l.query=null},l.show=function(){e.selectFirstMatch?l.select(0):l.selected=null,l.visible=!0},l.load=a.debounce(function(i,h){l.query=i;var u=s.when(t({$query:i}));o=u,u.then(function(t){u===o&&(t=a.makeObjectArray(t.data||t,r()),t=n(t,h),l.items=t.slice(0,e.maxResultsToShow),l.items.length>0?l.show():l.reset())})},e.debounceDelay),l.selectNext=function(){l.select(++l.index)},l.selectPrior=function(){l.select(--l.index)},l.select=function(t){t<0?t=l.items.length-1:t>=l.items.length&&(t=0),l.index=t,l.selected=l.items[t],i.trigger("suggestion-selected",t)},l.reset(),l}function l(t,e){var i=t.find("li").eq(e),n=i.parent(),s=i.prop("offsetTop"),o=i.prop("offsetHeight"),a=n.prop("clientHeight"),r=n.prop("scrollTop");s<r?n.prop("scrollTop",s):s+o>a+r&&n.prop("scrollTop",s+o-a)}return{restrict:"E",require:"^tagsInput",scope:{source:"&",matchClass:"&"},templateUrl:"ngTagsInput/auto-complete.html",controller:["$scope","$element","$attrs",function(t,e,i){t.events=a.simplePubSub(),o.load("autoComplete",t,i,{template:[String,"ngTagsInput/auto-complete-match.html"],debounceDelay:[Number,100],minLength:[Number,3],highlightMatchedText:[Boolean,!0],maxResultsToShow:[Number,10],loadOnDownArrow:[Boolean,!1],loadOnEmpty:[Boolean,!1],loadOnFocus:[Boolean,!1],selectFirstMatch:[Boolean,!0],displayProperty:[String,""]}),t.suggestionList=new r(t.source,t.options,t.events),this.registerAutocompleteMatch=function(){return{getOptions:function(){return t.options},getQuery:function(){return t.suggestionList.query}}}}],link:function(e,i,n,s){var o,r=[t.enter,t.tab,t.escape,t.up,t.down],h=e.suggestionList,u=s.registerAutocomplete(),c=e.options,d=e.events;c.tagsInput=u.getOptions(),o=function(t){return t&&t.length>=c.minLength||!t&&c.loadOnEmpty},e.templateScope=u.getTemplateScope(),e.addSuggestionByIndex=function(t){h.select(t),e.addSuggestion()},e.addSuggestion=function(){var t=!1;return h.selected&&(u.addTag(angular.copy(h.selected)),h.reset(),t=!0),t},e.track=function(t){return t[c.tagsInput.keyProperty||c.tagsInput.displayProperty]},e.getSuggestionClass=function(t,i){var n=t===h.selected;return[e.matchClass({$match:t,$index:i,$selected:n}),{selected:n}]},u.on("tag-added tag-removed invalid-tag input-blur",function(){h.reset()}).on("input-change",function(t){o(t)?h.load(t,u.getTags()):h.reset()}).on("input-focus",function(){var t=u.getCurrentTagText();c.loadOnFocus&&o(t)&&h.load(t,u.getTags())}).on("input-keydown",function(i){var n=i.keyCode,s=!1;if(!a.isModifierOn(i)&&r.indexOf(n)!==-1)return h.visible?n===t.down?(h.selectNext(),s=!0):n===t.up?(h.selectPrior(),s=!0):n===t.escape?(h.reset(),s=!0):n!==t.enter&&n!==t.tab||(s=e.addSuggestion()):n===t.down&&e.options.loadOnDownArrow&&(h.load(u.getCurrentTagText(),u.getTags()),s=!0),s?(i.preventDefault(),i.stopImmediatePropagation(),!1):void 0}),d.on("suggestion-selected",function(t){l(i,t)})}}}]),n.directive("tiAutocompleteMatch",["$sce","tiUtil",function(t,e){return{restrict:"E",require:"^autoComplete",template:'<ng-include src="$$template"></ng-include>',scope:{$scope:"=scope",data:"="},link:function(i,n,s,o){var a=o.registerAutocompleteMatch(),r=a.getOptions();i.$$template=r.template,i.$index=i.$parent.$index,i.$highlight=function(i){return r.highlightMatchedText&&(i=e.safeHighlight(i,a.getQuery())),t.trustAsHtml(i)},i.$getDisplayText=function(){return e.safeToString(i.data[r.displayProperty||r.tagsInput.displayProperty])}}}}]),n.directive("tiTranscludeAppend",function(){return function(t,e,i,n,s){s(function(t){e.append(t)})}}),n.directive("tiAutosize",["tagsInputConfig",function(t){return{restrict:"A",require:"ngModel",link:function(e,i,n,s){var o,a;t.getTextAutosizeThreshold();o=angular.element('<span class="input"></span>'),o.css("display","none").css("visibility","hidden").css("white-space","pre"),i.parent().append(o),a=function(t){var e=t;return angular.isString(e)&&0===e.length&&(e=n.placeholder),e&&(o.text(e),o.css("display",""),o.css("display","none")),t},s.$parsers.unshift(a),s.$formatters.unshift(a),n.$observe("placeholder",function(t){s.$modelValue||a(t)})}}}]),n.directive("tiBindAttrs",function(){return function(t,e,i){t.$watch(i.tiBindAttrs,function(t){angular.forEach(t,function(t,e){i.$set(e,t)})},!0)}}),n.provider("tagsInputConfig",function(){var t={},e={},i=3;this.setDefaults=function(e,i){return t[e]=i,this},this.setActiveInterpolation=function(t,i){return e[t]=i,this},this.setTextAutosizeThreshold=function(t){return i=t,this},this.$get=["$interpolate",function(n){var s={};return s[String]=function(t){return t},s[Number]=function(t){return parseInt(t,10)},s[Boolean]=function(t){return"true"===t.toLowerCase()},s[RegExp]=function(t){return new RegExp(t)},{load:function(i,o,a,r){var l=function(){return!0};o.options={},angular.forEach(r,function(r,h){var u,c,d,p,g,f;u=r[0],c=r[1],d=r[2]||l,p=s[u],g=function(){var e=t[i]&&t[i][h];return angular.isDefined(e)?e:c},f=function(t){o.options[h]=t&&d(t)?p(t):g()},e[i]&&e[i][h]?a.$observe(h,function(t){f(t),o.events.trigger("option-change",{name:h,newValue:t})}):f(a[h]&&n(a[h])(o.$parent))})},getTextAutosizeThreshold:function(){return i}}}]}),n.factory("tiUtil",["$timeout","$q",function(t,e){var i={};return i.debounce=function(e,i){var n;return function(){var s=arguments;t.cancel(n),n=t(function(){e.apply(null,s)},i)}},i.makeObjectArray=function(t,e){if(!angular.isArray(t)||0===t.length||angular.isObject(t[0]))return t;var i=[];return t.forEach(function(t){var n={};n[e]=t,i.push(n)}),i},i.findInObjectArray=function(t,e,n,s){var o=null;return s=s||i.defaultComparer,t.some(function(t){if(s(t[n],e[n]))return o=t,!0}),o},i.defaultComparer=function(t,e){return i.safeToString(t).toLowerCase()===i.safeToString(e).toLowerCase()},i.safeHighlight=function(t,e){function n(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}if(!e)return t;t=i.encodeHTML(t),e=i.encodeHTML(e);var s=new RegExp("&[^;]+;|"+n(e),"gi");return t.replace(s,function(t){return t.toLowerCase()===e.toLowerCase()?"<em>"+t+"</em>":t})},i.safeToString=function(t){return angular.isUndefined(t)||null==t?"":t.toString().trim()},i.encodeHTML=function(t){return i.safeToString(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},i.handleUndefinedResult=function(t,e){return function(){var i=t.apply(null,arguments);return angular.isUndefined(i)?e:i}},i.replaceSpacesWithDashes=function(t){return i.safeToString(t).replace(/\s/g,"-")},i.isModifierOn=function(t){return t.shiftKey||t.ctrlKey||t.altKey||t.metaKey},i.promisifyValue=function(t){return t=!!angular.isUndefined(t)||t,e[t?"when":"reject"]()},i.simplePubSub=function(){var t={};return{on:function(e,i,n){return e.split(" ").forEach(function(e){t[e]||(t[e]=[]);var s=n?[].unshift:[].push;s.call(t[e],i)}),this},trigger:function(e,n){var s=t[e]||[];return s.every(function(t){return i.handleUndefinedResult(t,!0)(n)}),this}}},i}]),n.run(["$templateCache",function(t){t.put("ngTagsInput/tags-input.html",'<div class="host" tabindex="-1" ng-click="eventHandlers.host.click()" ti-transclude-append><div class="tags" ng-class="{focused: hasFocus}"><ul class="tag-list"><li class="tag-item" ng-repeat="tag in tagList.items track by track(tag)" ng-class="getTagClass(tag, $index)" ng-click="eventHandlers.tag.click(tag)"><ti-tag-item scope="templateScope" data="::tag"></ti-tag-item></li></ul><input class="input" autocomplete="off" ng-model="newTag.text" ng-model-options="{getterSetter: true}" ng-keydown="eventHandlers.input.keydown($event)" ng-focus="eventHandlers.input.focus($event)" ng-blur="eventHandlers.input.blur($event)" ng-paste="eventHandlers.input.paste($event)" ng-trim="false" ng-class="{\'invalid-tag\': newTag.invalid}" ng-disabled="disabled" ti-bind-attrs="{type: options.type, placeholder: options.placeholder, tabindex: options.tabindex, spellcheck: options.spellcheck}" ti-autosize></div></div>'),t.put("ngTagsInput/tag-item.html",'<span ng-bind="$getDisplayText()"></span> <a class="remove-button" ng-click="$removeTag()" ng-bind="::$$removeTagSymbol"></a>'),t.put("ngTagsInput/auto-complete.html",'<div class="autocomplete" ng-if="suggestionList.visible"><ul class="suggestion-list"><li class="suggestion-item" ng-repeat="item in suggestionList.items track by track(item)" ng-class="getSuggestionClass(item, $index)" ng-click="addSuggestionByIndex($index)" ng-mouseenter="suggestionList.select($index)"><ti-autocomplete-match scope="templateScope" data="::item"></ti-autocomplete-match></li></ul></div>'),t.put("ngTagsInput/auto-complete-match.html",'<span ng-bind-html="$highlight($getDisplayText())"></span>')}])}(),function(t,e){"use strict";if("function"==typeof define&&define.amd)define(["angular"],e);else if("object"==typeof module&&module.exports){var i=angular||require("angular");i&&i.module||"undefined"==typeof angular||(i=angular),module.exports=e(i)}else e(t.angular)}(this,function(t){"use strict";var e=t.module("rzModule",[]).factory("RzSliderOptions",function(){var e={floor:0,ceil:null,step:1,precision:0,minRange:null,maxRange:null,pushRange:!1,minLimit:null,maxLimit:null,id:null,translate:null,getLegend:null,stepsArray:null,bindIndexForStepsArray:!1,draggableRange:!1,draggableRangeOnly:!1,showSelectionBar:!1,showSelectionBarEnd:!1,showSelectionBarFromValue:null,hidePointerLabels:!1,hideLimitLabels:!1,autoHideLimitLabels:!0,readOnly:!1,disabled:!1,interval:350,showTicks:!1,showTicksValues:!1,ticksArray:null,ticksTooltip:null,ticksValuesTooltip:null,vertical:!1,getSelectionBarColor:null,getTickColor:null,getPointerColor:null,keyboardSupport:!0,scale:1,enforceStep:!0,enforceRange:!1,noSwitching:!1,onlyBindHandles:!1,onStart:null,onChange:null,onEnd:null,rightToLeft:!1,boundPointerLabels:!0,mergeRangeLabelsIfSame:!1,customTemplateScope:null,logScale:!1,customValueToPosition:null,customPositionToValue:null,selectionBarGradient:null},i={},n={};return n.options=function(e){t.extend(i,e)},n.getOptions=function(n){return t.extend({},e,i,n)},n}).factory("rzThrottle",["$timeout",function(t){return function(e,i,n){var s,o,a,r=Date.now||function(){return(new Date).getTime()},l=null,h=0;n=n||{};var u=function(){h=r(),l=null,a=e.apply(s,o),s=o=null};return function(){var c=r(),d=i-(c-h);return s=this,o=arguments,d<=0?(t.cancel(l),l=null,h=c,a=e.apply(s,o),s=o=null):l||n.trailing===!1||(l=t(u,d)),a}}}]).factory("RzSlider",["$timeout","$document","$window","$compile","RzSliderOptions","rzThrottle",function(e,i,n,s,o,a){var r=function(t,e){this.scope=t,this.lowValue=0,this.highValue=0,this.sliderElem=e,this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.dragging={active:!1,value:0,difference:0,position:0,lowLimit:0,highLimit:0},this.positionProperty="left",this.dimensionProperty="width",this.handleHalfDim=0,this.maxPos=0,this.precision=0,this.step=1,this.tracking="",this.minValue=0,this.maxValue=0,this.valueRange=0,this.intermediateTicks=!1,this.initHasRun=!1,this.firstKeyDown=!1,this.internalChange=!1,this.cmbLabelShown=!1,this.currentFocusElement=null,this.fullBar=null,this.selBar=null,this.minH=null,this.maxH=null,this.flrLab=null,this.ceilLab=null,this.minLab=null,this.maxLab=null,this.cmbLab=null,this.ticks=null,this.init()};return r.prototype={init:function(){var e,i,s=this,o=function(){s.calcViewDimensions()};this.applyOptions(),this.syncLowValue(),this.range&&this.syncHighValue(),this.initElemHandles(),this.manageElementsStyle(),this.setDisabledState(),this.calcViewDimensions(),this.setMinAndMax(),this.addAccessibility(),this.updateCeilLab(),this.updateFloorLab(),this.initHandles(),this.manageEventsBindings(),this.scope.$on("reCalcViewDimensions",o),t.element(n).on("resize",o),this.initHasRun=!0,e=a(function(){s.onLowHandleChange()},s.options.interval),i=a(function(){s.onHighHandleChange()},s.options.interval),this.scope.$on("rzSliderForceRender",function(){s.resetLabelsValue(),e(),s.range&&i(),s.resetSlider()}),this.scope.$watch("rzSliderOptions()",function(t,e){t!==e&&(s.applyOptions(),s.syncLowValue(),s.range&&s.syncHighValue(),s.resetSlider())},!0),this.scope.$watch("rzSliderModel",function(t,i){s.internalChange||t!==i&&e()}),this.scope.$watch("rzSliderHigh",function(t,e){s.internalChange||t!==e&&(null!=t&&i(),(s.range&&null==t||!s.range&&null!=t)&&(s.applyOptions(),s.resetSlider()))}),this.scope.$on("$destroy",function(){s.unbindEvents(),t.element(n).off("resize",o),s.currentFocusElement=null})},findStepIndex:function(e){for(var i=0,n=0;n<this.options.stepsArray.length;n++){var s=this.options.stepsArray[n];if(s===e){i=n;break}if(t.isDate(s)){if(s.getTime()===e.getTime()){i=n;break}}else if(t.isObject(s)&&(t.isDate(s.value)&&s.value.getTime()===e.getTime()||s.value===e)){i=n;break}}return i},syncLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.lowValue=this.scope.rzSliderModel:this.lowValue=this.findStepIndex(this.scope.rzSliderModel):this.lowValue=this.scope.rzSliderModel},syncHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.highValue=this.scope.rzSliderHigh:this.highValue=this.findStepIndex(this.scope.rzSliderHigh):this.highValue=this.scope.rzSliderHigh},getStepValue:function(e){var i=this.options.stepsArray[e];return t.isDate(i)?i:t.isObject(i)?i.value:i},applyLowValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderModel=this.lowValue:this.scope.rzSliderModel=this.getStepValue(this.lowValue):this.scope.rzSliderModel=this.lowValue},applyHighValue:function(){this.options.stepsArray?this.options.bindIndexForStepsArray?this.scope.rzSliderHigh=this.highValue:this.scope.rzSliderHigh=this.getStepValue(this.highValue):this.scope.rzSliderHigh=this.highValue},onLowHandleChange:function(){this.syncLowValue(),this.range&&this.syncHighValue(),this.setMinAndMax(),this.updateLowHandle(this.valueToPosition(this.lowValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateAriaAttributes(),this.range&&this.updateCmbLabel()},onHighHandleChange:function(){this.syncLowValue(),this.syncHighValue(),this.setMinAndMax(),this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.updateTicksScale(),this.updateCmbLabel(),this.updateAriaAttributes()},applyOptions:function(){var e;e=this.scope.rzSliderOptions?this.scope.rzSliderOptions():{},this.options=o.getOptions(e),this.options.step<=0&&(this.options.step=1),this.range=void 0!==this.scope.rzSliderModel&&void 0!==this.scope.rzSliderHigh,this.options.draggableRange=this.range&&this.options.draggableRange,this.options.draggableRangeOnly=this.range&&this.options.draggableRangeOnly,this.options.draggableRangeOnly&&(this.options.draggableRange=!0),this.options.showTicks=this.options.showTicks||this.options.showTicksValues||!!this.options.ticksArray,this.scope.showTicks=this.options.showTicks,(t.isNumber(this.options.showTicks)||this.options.ticksArray)&&(this.intermediateTicks=!0),this.options.showSelectionBar=this.options.showSelectionBar||this.options.showSelectionBarEnd||null!==this.options.showSelectionBarFromValue,this.options.stepsArray?this.parseStepsArray():(this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(t){return String(t)},this.getLegend=this.options.getLegend),this.options.vertical&&(this.positionProperty="bottom",this.dimensionProperty="height"),this.options.customTemplateScope&&(this.scope.custom=this.options.customTemplateScope)},parseStepsArray:function(){this.options.floor=0,this.options.ceil=this.options.stepsArray.length-1,this.options.step=1,this.options.translate?this.customTrFn=this.options.translate:this.customTrFn=function(t){return this.options.bindIndexForStepsArray?this.getStepValue(t):t},this.getLegend=function(e){var i=this.options.stepsArray[e];return t.isObject(i)?i.legend:null}},resetSlider:function(){this.manageElementsStyle(),this.addAccessibility(),this.setMinAndMax(),this.updateCeilLab(),this.updateFloorLab(),this.unbindEvents(),this.manageEventsBindings(),this.setDisabledState(),this.calcViewDimensions(),this.refocusPointerIfNeeded()},refocusPointerIfNeeded:function(){this.currentFocusElement&&(this.onPointerFocus(this.currentFocusElement.pointer,this.currentFocusElement.ref),this.focusElement(this.currentFocusElement.pointer))},initElemHandles:function(){t.forEach(this.sliderElem.children(),function(e,i){var n=t.element(e);switch(i){case 0:this.fullBar=n;break;case 1:this.selBar=n;break;case 2:this.minH=n;break;case 3:this.maxH=n;break;case 4:this.flrLab=n;break;case 5:this.ceilLab=n;break;case 6:this.minLab=n;break;case 7:this.maxLab=n;break;case 8:this.cmbLab=n;break;case 9:this.ticks=n}},this),this.selBar.rzsp=0,this.minH.rzsp=0,this.maxH.rzsp=0,this.flrLab.rzsp=0,this.ceilLab.rzsp=0,this.minLab.rzsp=0,this.maxLab.rzsp=0,this.cmbLab.rzsp=0},manageElementsStyle:function(){this.range?this.maxH.css("display",""):this.maxH.css("display","none"),this.alwaysHide(this.flrLab,this.options.showTicksValues||this.options.hideLimitLabels),this.alwaysHide(this.ceilLab,this.options.showTicksValues||this.options.hideLimitLabels);var t=this.options.showTicksValues&&!this.intermediateTicks;this.alwaysHide(this.minLab,t||this.options.hidePointerLabels),this.alwaysHide(this.maxLab,t||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.cmbLab,t||!this.range||this.options.hidePointerLabels),this.alwaysHide(this.selBar,!this.range&&!this.options.showSelectionBar),this.options.vertical&&this.sliderElem.addClass("rz-vertical"),this.options.draggableRange?this.selBar.addClass("rz-draggable"):this.selBar.removeClass("rz-draggable"),this.intermediateTicks&&this.options.showTicksValues&&this.ticks.addClass("rz-ticks-values-under")},alwaysHide:function(t,e){t.rzAlwaysHide=e,e?this.hideEl(t):this.showEl(t)},manageEventsBindings:function(){this.options.disabled||this.options.readOnly?this.unbindEvents():this.bindEvents()},setDisabledState:function(){this.options.disabled?this.sliderElem.attr("disabled","disabled"):this.sliderElem.attr("disabled",null)},resetLabelsValue:function(){this.minLab.rzsv=void 0,this.maxLab.rzsv=void 0},initHandles:function(){this.updateLowHandle(this.valueToPosition(this.lowValue)),this.range&&this.updateHighHandle(this.valueToPosition(this.highValue)),this.updateSelectionBar(),this.range&&this.updateCmbLabel(),this.updateTicksScale()},translateFn:function(t,e,i,n){n=void 0===n||n;var s="",o=!1,a=e.hasClass("no-label-injection");n?(this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(t=this.getStepValue(t)),s=String(this.customTrFn(t,this.options.id,i))):s=String(t),(void 0===e.rzsv||e.rzsv.length!==s.length||e.rzsv.length>0&&0===e.rzsd)&&(o=!0,e.rzsv=s),a||e.html(s),this.scope[i+"Label"]=s,o&&this.getDimension(e)},setMinAndMax:function(){if(this.step=+this.options.step,this.precision=+this.options.precision,this.minValue=this.options.floor,this.options.logScale&&0===this.minValue)throw Error("Can't use floor=0 with logarithmic scale");this.options.enforceStep&&(this.lowValue=this.roundStep(this.lowValue),this.range&&(this.highValue=this.roundStep(this.highValue))),null!=this.options.ceil?this.maxValue=this.options.ceil:this.maxValue=this.options.ceil=this.range?this.highValue:this.lowValue,this.options.enforceRange&&(this.lowValue=this.sanitizeValue(this.lowValue),this.range&&(this.highValue=this.sanitizeValue(this.highValue))),this.applyLowValue(),this.range&&this.applyHighValue(),this.valueRange=this.maxValue-this.minValue},addAccessibility:function(){this.minH.attr("role","slider"),this.updateAriaAttributes(),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.minH.attr("tabindex",""):this.minH.attr("tabindex","0"),this.options.vertical&&this.minH.attr("aria-orientation","vertical"),this.range&&(this.maxH.attr("role","slider"),!this.options.keyboardSupport||this.options.readOnly||this.options.disabled?this.maxH.attr("tabindex",""):this.maxH.attr("tabindex","0"),this.options.vertical&&this.maxH.attr("aria-orientation","vertical"))},updateAriaAttributes:function(){this.minH.attr({"aria-valuenow":this.scope.rzSliderModel,"aria-valuetext":this.customTrFn(this.scope.rzSliderModel,this.options.id,"model"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue}),this.range&&this.maxH.attr({"aria-valuenow":this.scope.rzSliderHigh,"aria-valuetext":this.customTrFn(this.scope.rzSliderHigh,this.options.id,"high"),"aria-valuemin":this.minValue,"aria-valuemax":this.maxValue})},calcViewDimensions:function(){var t=this.getDimension(this.minH);if(this.handleHalfDim=t/2,this.barDimension=this.getDimension(this.fullBar),this.maxPos=this.barDimension-t,this.getDimension(this.sliderElem),this.sliderElem.rzsp=this.sliderElem[0].getBoundingClientRect()[this.positionProperty],this.initHasRun){this.updateFloorLab(),this.updateCeilLab(),this.initHandles();var i=this;e(function(){i.updateTicksScale()})}},updateTicksScale:function(){if(this.options.showTicks){var t=this.options.ticksArray||this.getTicksArray(),e=this.options.vertical?"translateY":"translateX",i=this;this.options.rightToLeft&&t.reverse(),this.scope.ticks=t.map(function(t){var n=i.valueToPosition(t);i.options.vertical&&(n=i.maxPos-n);var s={selected:i.isTickSelected(t),style:{transform:e+"("+Math.round(n)+"px)"}};if(s.selected&&i.options.getSelectionBarColor&&(s.style["background-color"]=i.getSelectionBarColor()),!s.selected&&i.options.getTickColor&&(s.style["background-color"]=i.getTickColor(t)),i.options.ticksTooltip&&(s.tooltip=i.options.ticksTooltip(t),s.tooltipPlacement=i.options.vertical?"right":"top"),i.options.showTicksValues&&(s.value=i.getDisplayValue(t,"tick-value"),i.options.ticksValuesTooltip&&(s.valueTooltip=i.options.ticksValuesTooltip(t),s.valueTooltipPlacement=i.options.vertical?"right":"top")),i.getLegend){var o=i.getLegend(t,i.options.id);o&&(s.legend=o)}return s})}},getTicksArray:function(){var t=this.step,e=[];this.intermediateTicks&&(t=this.options.showTicks);for(var i=this.minValue;i<=this.maxValue;i+=t)e.push(i);return e},isTickSelected:function(t){if(!this.range)if(null!==this.options.showSelectionBarFromValue){var e=this.options.showSelectionBarFromValue;if(this.lowValue>e&&t>=e&&t<=this.lowValue)return!0;if(this.lowValue<e&&t<=e&&t>=this.lowValue)return!0}else if(this.options.showSelectionBarEnd){if(t>=this.lowValue)return!0}else if(this.options.showSelectionBar&&t<=this.lowValue)return!0;return!!(this.range&&t>=this.lowValue&&t<=this.highValue)},updateFloorLab:function(){this.translateFn(this.minValue,this.flrLab,"floor"),this.getDimension(this.flrLab);var t=this.options.rightToLeft?this.barDimension-this.flrLab.rzsd:0;this.setPosition(this.flrLab,t)},updateCeilLab:function(){this.translateFn(this.maxValue,this.ceilLab,"ceil"),this.getDimension(this.ceilLab);var t=this.options.rightToLeft?0:this.barDimension-this.ceilLab.rzsd;this.setPosition(this.ceilLab,t)},updateHandles:function(t,e){"lowValue"===t?this.updateLowHandle(e):this.updateHighHandle(e),this.updateSelectionBar(),this.updateTicksScale(),this.range&&this.updateCmbLabel()},getHandleLabelPos:function(t,e){var i=this[t].rzsd,n=e-i/2+this.handleHalfDim,s=this.barDimension-i;return this.options.boundPointerLabels?this.options.rightToLeft&&"minLab"===t||!this.options.rightToLeft&&"maxLab"===t?Math.min(n,s):Math.min(Math.max(n,0),s):n},updateLowHandle:function(t){if(this.setPosition(this.minH,t),this.translateFn(this.lowValue,this.minLab,"model"),this.setPosition(this.minLab,this.getHandleLabelPos("minLab",t)),this.options.getPointerColor){var e=this.getPointerColor("min");this.scope.minPointerStyle={backgroundColor:e}}this.options.autoHideLimitLabels&&this.shFloorCeil()},updateHighHandle:function(t){if(this.setPosition(this.maxH,t),this.translateFn(this.highValue,this.maxLab,"high"),this.setPosition(this.maxLab,this.getHandleLabelPos("maxLab",t)),this.options.getPointerColor){var e=this.getPointerColor("max");this.scope.maxPointerStyle={backgroundColor:e}}this.options.autoHideLimitLabels&&this.shFloorCeil()},shFloorCeil:function(){if(!this.options.hidePointerLabels){var t=!1,e=!1,i=this.isLabelBelowFloorLab(this.minLab),n=this.isLabelAboveCeilLab(this.minLab),s=this.isLabelAboveCeilLab(this.maxLab),o=this.isLabelBelowFloorLab(this.cmbLab),a=this.isLabelAboveCeilLab(this.cmbLab);if(i?(t=!0,this.hideEl(this.flrLab)):(t=!1,this.showEl(this.flrLab)),n?(e=!0,this.hideEl(this.ceilLab)):(e=!1,this.showEl(this.ceilLab)),this.range){var r=this.cmbLabelShown?a:s,l=this.cmbLabelShown?o:i;r?this.hideEl(this.ceilLab):e||this.showEl(this.ceilLab),l?this.hideEl(this.flrLab):t||this.showEl(this.flrLab)}}},isLabelBelowFloorLab:function(t){var e=this.options.rightToLeft,i=t.rzsp,n=t.rzsd,s=this.flrLab.rzsp,o=this.flrLab.rzsd;return e?i+n>=s-2:i<=s+o+2},isLabelAboveCeilLab:function(t){var e=this.options.rightToLeft,i=t.rzsp,n=t.rzsd,s=this.ceilLab.rzsp,o=this.ceilLab.rzsd;return e?i<=s+o+2:i+n>=s-2},updateSelectionBar:function(){var t=0,e=0,i=this.options.rightToLeft?!this.options.showSelectionBarEnd:this.options.showSelectionBarEnd,n=this.options.rightToLeft?this.maxH.rzsp+this.handleHalfDim:this.minH.rzsp+this.handleHalfDim;if(this.range)e=Math.abs(this.maxH.rzsp-this.minH.rzsp),t=n;else if(null!==this.options.showSelectionBarFromValue){var s=this.options.showSelectionBarFromValue,o=this.valueToPosition(s),a=this.options.rightToLeft?this.lowValue<=s:this.lowValue>s;a?(e=this.minH.rzsp-o,t=o+this.handleHalfDim):(e=o-this.minH.rzsp,t=this.minH.rzsp+this.handleHalfDim)}else i?(e=Math.abs(this.maxPos-this.minH.rzsp)+this.handleHalfDim,t=this.minH.rzsp+this.handleHalfDim):(e=Math.abs(this.maxH.rzsp-this.minH.rzsp)+this.handleHalfDim,t=0);if(this.setDimension(this.selBar,e),this.setPosition(this.selBar,t),this.options.getSelectionBarColor){var r=this.getSelectionBarColor();this.scope.barStyle={backgroundColor:r}}else if(this.options.selectionBarGradient){var l=null!==this.options.showSelectionBarFromValue?this.valueToPosition(this.options.showSelectionBarFromValue):0,h=l-t>0^i,u=this.options.vertical?h?"bottom":"top":h?"left":"right";this.scope.barStyle={backgroundImage:"linear-gradient(to "+u+", "+this.options.selectionBarGradient.from+" 0%,"+this.options.selectionBarGradient.to+" 100%)"},this.options.vertical?(this.scope.barStyle.backgroundPosition="center "+(l+e+t+(h?-this.handleHalfDim:0))+"px",this.scope.barStyle.backgroundSize="100% "+(this.barDimension-this.handleHalfDim)+"px"):(this.scope.barStyle.backgroundPosition=l-t+(h?this.handleHalfDim:0)+"px center",this.scope.barStyle.backgroundSize=this.barDimension-this.handleHalfDim+"px 100%")}},getSelectionBarColor:function(){return this.range?this.options.getSelectionBarColor(this.scope.rzSliderModel,this.scope.rzSliderHigh):this.options.getSelectionBarColor(this.scope.rzSliderModel)},getPointerColor:function(t){return"max"===t?this.options.getPointerColor(this.scope.rzSliderHigh,t):this.options.getPointerColor(this.scope.rzSliderModel,t)},getTickColor:function(t){return this.options.getTickColor(t)},updateCmbLabel:function(){var t=null;if(t=this.options.rightToLeft?this.minLab.rzsp-this.minLab.rzsd-10<=this.maxLab.rzsp:this.minLab.rzsp+this.minLab.rzsd+10>=this.maxLab.rzsp){var e=this.getDisplayValue(this.lowValue,"model"),i=this.getDisplayValue(this.highValue,"high"),n="";n=this.options.mergeRangeLabelsIfSame&&e===i?e:this.options.rightToLeft?i+" - "+e:e+" - "+i,this.translateFn(n,this.cmbLab,"cmb",!1);var s=this.options.boundPointerLabels?Math.min(Math.max(this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2,0),this.barDimension-this.cmbLab.rzsd):this.selBar.rzsp+this.selBar.rzsd/2-this.cmbLab.rzsd/2;this.setPosition(this.cmbLab,s),this.cmbLabelShown=!0,this.hideEl(this.minLab),this.hideEl(this.maxLab),this.showEl(this.cmbLab)}else this.cmbLabelShown=!1,this.showEl(this.maxLab),this.showEl(this.minLab),this.hideEl(this.cmbLab);this.options.autoHideLimitLabels&&this.shFloorCeil()},getDisplayValue:function(t,e){return this.options.stepsArray&&!this.options.bindIndexForStepsArray&&(t=this.getStepValue(t)),this.customTrFn(t,this.options.id,e)},roundStep:function(t,e){var i=e?e:this.step,n=parseFloat((t-this.minValue)/i).toPrecision(12);n=Math.round(+n)*i;var s=(this.minValue+n).toFixed(this.precision);return+s},hideEl:function(t){return t.css({visibility:"hidden"})},showEl:function(t){return t.rzAlwaysHide?t:t.css({visibility:"visible"})},setPosition:function(t,e){t.rzsp=e;var i={};return i[this.positionProperty]=Math.round(e)+"px",t.css(i),e},getDimension:function(t){var e=t[0].getBoundingClientRect();return this.options.vertical?t.rzsd=(e.bottom-e.top)*this.options.scale:t.rzsd=(e.right-e.left)*this.options.scale,t.rzsd},setDimension:function(t,e){t.rzsd=e;var i={};return i[this.dimensionProperty]=Math.round(e)+"px",t.css(i),e},sanitizeValue:function(t){return Math.min(Math.max(t,this.minValue),this.maxValue)},valueToPosition:function(t){var e=this.linearValueToPosition;this.options.customValueToPosition?e=this.options.customValueToPosition:this.options.logScale&&(e=this.logValueToPosition),t=this.sanitizeValue(t);var i=e(t,this.minValue,this.maxValue)||0;return this.options.rightToLeft&&(i=1-i),i*this.maxPos},linearValueToPosition:function(t,e,i){var n=i-e;return(t-e)/n},logValueToPosition:function(t,e,i){t=Math.log(t),e=Math.log(e),i=Math.log(i);var n=i-e;return(t-e)/n},positionToValue:function(t){var e=t/this.maxPos;this.options.rightToLeft&&(e=1-e);var i=this.linearPositionToValue;return this.options.customPositionToValue?i=this.options.customPositionToValue:this.options.logScale&&(i=this.logPositionToValue),i(e,this.minValue,this.maxValue)||0},linearPositionToValue:function(t,e,i){return t*(i-e)+e},logPositionToValue:function(t,e,i){e=Math.log(e),i=Math.log(i);var n=t*(i-e)+e;return Math.exp(n)},getEventXY:function(t){var e=this.options.vertical?"clientY":"clientX";return void 0!==t[e]?t[e]:void 0===t.originalEvent?t.touches[0][e]:t.originalEvent.touches[0][e]},getEventPosition:function(t){var e=this.sliderElem.rzsp,i=0;return i=this.options.vertical?-this.getEventXY(t)+e:this.getEventXY(t)-e,i*this.options.scale-this.handleHalfDim},getEventNames:function(t){var e={moveEvent:"",endEvent:""};return t.touches||void 0!==t.originalEvent&&t.originalEvent.touches?(e.moveEvent="touchmove",e.endEvent="touchend"):(e.moveEvent="mousemove",
e.endEvent="mouseup"),e},getNearestHandle:function(t){if(!this.range)return this.minH;var e=this.getEventPosition(t),i=Math.abs(e-this.minH.rzsp),n=Math.abs(e-this.maxH.rzsp);return i<n?this.minH:i>n?this.maxH:this.options.rightToLeft?e>this.minH.rzsp?this.minH:this.maxH:e<this.minH.rzsp?this.minH:this.maxH},focusElement:function(t){var e=0;t[e].focus()},bindEvents:function(){var e,i,n;this.options.draggableRange?(e="rzSliderDrag",i=this.onDragStart,n=this.onDragMove):(e="lowValue",i=this.onStart,n=this.onMove),this.options.onlyBindHandles||(this.selBar.on("mousedown",t.bind(this,i,null,e)),this.selBar.on("mousedown",t.bind(this,n,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("mousedown",t.bind(this,i,null,e)),this.maxH.on("mousedown",t.bind(this,i,null,e))):(this.minH.on("mousedown",t.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("mousedown",t.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("mousedown",t.bind(this,this.onStart,null,null)),this.fullBar.on("mousedown",t.bind(this,this.onMove,this.fullBar)),this.ticks.on("mousedown",t.bind(this,this.onStart,null,null)),this.ticks.on("mousedown",t.bind(this,this.onTickClick,this.ticks)))),this.options.onlyBindHandles||(this.selBar.on("touchstart",t.bind(this,i,null,e)),this.selBar.on("touchstart",t.bind(this,n,this.selBar))),this.options.draggableRangeOnly?(this.minH.on("touchstart",t.bind(this,i,null,e)),this.maxH.on("touchstart",t.bind(this,i,null,e))):(this.minH.on("touchstart",t.bind(this,this.onStart,this.minH,"lowValue")),this.range&&this.maxH.on("touchstart",t.bind(this,this.onStart,this.maxH,"highValue")),this.options.onlyBindHandles||(this.fullBar.on("touchstart",t.bind(this,this.onStart,null,null)),this.fullBar.on("touchstart",t.bind(this,this.onMove,this.fullBar)),this.ticks.on("touchstart",t.bind(this,this.onStart,null,null)),this.ticks.on("touchstart",t.bind(this,this.onTickClick,this.ticks)))),this.options.keyboardSupport&&(this.minH.on("focus",t.bind(this,this.onPointerFocus,this.minH,"lowValue")),this.range&&this.maxH.on("focus",t.bind(this,this.onPointerFocus,this.maxH,"highValue")))},unbindEvents:function(){this.minH.off(),this.maxH.off(),this.fullBar.off(),this.selBar.off(),this.ticks.off()},onStart:function(e,n,s){var o,a,r=this.getEventNames(s);s.stopPropagation(),s.preventDefault(),this.calcViewDimensions(),e?this.tracking=n:(e=this.getNearestHandle(s),this.tracking=e===this.minH?"lowValue":"highValue"),e.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(e),o=t.bind(this,this.dragging.active?this.onDragMove:this.onMove,e),a=t.bind(this,this.onEnd,o),i.on(r.moveEvent,o),i.one(r.endEvent,a),this.callOnStart()},onMove:function(e,i,n){var s,o=this.getEventPosition(i),a=this.options.rightToLeft?this.minValue:this.maxValue,r=this.options.rightToLeft?this.maxValue:this.minValue;o<=0?s=r:o>=this.maxPos?s=a:(s=this.positionToValue(o),s=n&&t.isNumber(this.options.showTicks)?this.roundStep(s,this.options.showTicks):this.roundStep(s)),this.positionTrackingHandle(s)},onEnd:function(t,e){var n=this.getEventNames(e).moveEvent;this.options.keyboardSupport||(this.minH.removeClass("rz-active"),this.maxH.removeClass("rz-active"),this.tracking=""),this.dragging.active=!1,i.off(n,t),this.callOnEnd()},onTickClick:function(t,e){this.onMove(t,e,!0)},onPointerFocus:function(e,i){this.tracking=i,e.one("blur",t.bind(this,this.onPointerBlur,e)),e.on("keydown",t.bind(this,this.onKeyboardEvent)),e.on("keyup",t.bind(this,this.onKeyUp)),this.firstKeyDown=!0,e.addClass("rz-active"),this.currentFocusElement={pointer:e,ref:i}},onKeyUp:function(){this.firstKeyDown=!0,this.callOnEnd()},onPointerBlur:function(t){t.off("keydown"),t.off("keyup"),this.tracking="",t.removeClass("rz-active"),this.currentFocusElement=null},getKeyActions:function(t){var e=t+this.step,i=t-this.step,n=t+this.valueRange/10,s=t-this.valueRange/10,o={UP:e,DOWN:i,LEFT:i,RIGHT:e,PAGEUP:n,PAGEDOWN:s,HOME:this.minValue,END:this.maxValue};return this.options.rightToLeft&&(o.LEFT=e,o.RIGHT=i,this.options.vertical&&(o.UP=i,o.DOWN=e)),o},onKeyboardEvent:function(t){var i=this[this.tracking],n=t.keyCode||t.which,s={38:"UP",40:"DOWN",37:"LEFT",39:"RIGHT",33:"PAGEUP",34:"PAGEDOWN",36:"HOME",35:"END"},o=this.getKeyActions(i),a=s[n],r=o[a];if(null!=r&&""!==this.tracking){t.preventDefault(),this.firstKeyDown&&(this.firstKeyDown=!1,this.callOnStart());var l=this;e(function(){var t=l.roundStep(l.sanitizeValue(r));if(l.options.draggableRangeOnly){var e,i,n=l.highValue-l.lowValue;"lowValue"===l.tracking?(e=t,i=t+n,i>l.maxValue&&(i=l.maxValue,e=i-n)):(i=t,e=t-n,e<l.minValue&&(e=l.minValue,i=e+n)),l.positionTrackingBar(e,i)}else l.positionTrackingHandle(t)})}},onDragStart:function(t,e,i){var n=this.getEventPosition(i);this.dragging={active:!0,value:this.positionToValue(n),difference:this.highValue-this.lowValue,lowLimit:this.options.rightToLeft?this.minH.rzsp-n:n-this.minH.rzsp,highLimit:this.options.rightToLeft?n-this.maxH.rzsp:this.maxH.rzsp-n},this.onStart(t,e,i)},getValue:function(t,e,i,n){var s=this.options.rightToLeft,o=null;return o="min"===t?i?n?s?this.minValue:this.maxValue-this.dragging.difference:s?this.maxValue-this.dragging.difference:this.minValue:s?this.positionToValue(e+this.dragging.lowLimit):this.positionToValue(e-this.dragging.lowLimit):i?n?s?this.minValue+this.dragging.difference:this.maxValue:s?this.maxValue:this.minValue+this.dragging.difference:s?this.positionToValue(e+this.dragging.lowLimit)+this.dragging.difference:this.positionToValue(e-this.dragging.lowLimit)+this.dragging.difference,this.roundStep(o)},onDragMove:function(t,e){var i,n,s,o,a,r,l,h,u=this.getEventPosition(e);if(this.options.rightToLeft?(s=this.dragging.lowLimit,o=this.dragging.highLimit,l=this.maxH,h=this.minH):(s=this.dragging.highLimit,o=this.dragging.lowLimit,l=this.minH,h=this.maxH),a=u<=o,r=u>=this.maxPos-s,a){if(0===l.rzsp)return;i=this.getValue("min",u,!0,!1),n=this.getValue("max",u,!0,!1)}else if(r){if(h.rzsp===this.maxPos)return;n=this.getValue("max",u,!0,!0),i=this.getValue("min",u,!0,!0)}else i=this.getValue("min",u,!1),n=this.getValue("max",u,!1);this.positionTrackingBar(i,n)},positionTrackingBar:function(t,e){null!=this.options.minLimit&&t<this.options.minLimit&&(t=this.options.minLimit,e=t+this.dragging.difference),null!=this.options.maxLimit&&e>this.options.maxLimit&&(e=this.options.maxLimit,t=e-this.dragging.difference),this.lowValue=t,this.highValue=e,this.applyLowValue(),this.range&&this.applyHighValue(),this.applyModel(),this.updateHandles("lowValue",this.valueToPosition(t)),this.updateHandles("highValue",this.valueToPosition(e))},positionTrackingHandle:function(t){var e=!1;t=this.applyMinMaxLimit(t),this.range&&(this.options.pushRange?(t=this.applyPushRange(t),e=!0):(this.options.noSwitching&&("lowValue"===this.tracking&&t>this.highValue?t=this.applyMinMaxRange(this.highValue):"highValue"===this.tracking&&t<this.lowValue&&(t=this.applyMinMaxRange(this.lowValue))),t=this.applyMinMaxRange(t),"lowValue"===this.tracking&&t>this.highValue?(this.lowValue=this.highValue,this.applyLowValue(),this.updateHandles(this.tracking,this.maxH.rzsp),this.updateAriaAttributes(),this.tracking="highValue",this.minH.removeClass("rz-active"),this.maxH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.maxH),e=!0):"highValue"===this.tracking&&t<this.lowValue&&(this.highValue=this.lowValue,this.applyHighValue(),this.updateHandles(this.tracking,this.minH.rzsp),this.updateAriaAttributes(),this.tracking="lowValue",this.maxH.removeClass("rz-active"),this.minH.addClass("rz-active"),this.options.keyboardSupport&&this.focusElement(this.minH),e=!0))),this[this.tracking]!==t&&(this[this.tracking]=t,"lowValue"===this.tracking?this.applyLowValue():this.applyHighValue(),this.updateHandles(this.tracking,this.valueToPosition(t)),this.updateAriaAttributes(),e=!0),e&&this.applyModel()},applyMinMaxLimit:function(t){return null!=this.options.minLimit&&t<this.options.minLimit?this.options.minLimit:null!=this.options.maxLimit&&t>this.options.maxLimit?this.options.maxLimit:t},applyMinMaxRange:function(t){var e="lowValue"===this.tracking?this.highValue:this.lowValue,i=Math.abs(t-e);return null!=this.options.minRange&&i<this.options.minRange?"lowValue"===this.tracking?this.highValue-this.options.minRange:this.lowValue+this.options.minRange:null!=this.options.maxRange&&i>this.options.maxRange?"lowValue"===this.tracking?this.highValue-this.options.maxRange:this.lowValue+this.options.maxRange:t},applyPushRange:function(t){var e="lowValue"===this.tracking?this.highValue-t:t-this.lowValue,i=null!==this.options.minRange?this.options.minRange:this.options.step,n=this.options.maxRange;return e<i?("lowValue"===this.tracking?(this.highValue=Math.min(t+i,this.maxValue),t=this.highValue-i,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=Math.max(t-i,this.minValue),t=this.lowValue+i,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()):null!==n&&e>n&&("lowValue"===this.tracking?(this.highValue=t+n,this.applyHighValue(),this.updateHandles("highValue",this.valueToPosition(this.highValue))):(this.lowValue=t-n,this.applyLowValue(),this.updateHandles("lowValue",this.valueToPosition(this.lowValue))),this.updateAriaAttributes()),t},applyModel:function(){this.internalChange=!0,this.scope.$apply(),this.callOnChange(),this.internalChange=!1},callOnStart:function(){if(this.options.onStart){var t=this,e="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){t.options.onStart(t.options.id,t.scope.rzSliderModel,t.scope.rzSliderHigh,e)})}},callOnChange:function(){if(this.options.onChange){var t=this,e="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){t.options.onChange(t.options.id,t.scope.rzSliderModel,t.scope.rzSliderHigh,e)})}},callOnEnd:function(){if(this.options.onEnd){var t=this,e="lowValue"===this.tracking?"min":"max";this.scope.$evalAsync(function(){t.options.onEnd(t.options.id,t.scope.rzSliderModel,t.scope.rzSliderHigh,e)})}this.scope.$emit("slideEnded")}},r}]).directive("rzslider",["RzSlider",function(t){return{restrict:"AE",replace:!0,scope:{rzSliderModel:"=?",rzSliderHigh:"=?",rzSliderOptions:"&?",rzSliderTplUrl:"@"},templateUrl:function(t,e){return e.rzSliderTplUrl||"rzSliderTpl.html"},link:function(e,i){e.slider=new t(e,i)}}}]);return e.run(["$templateCache",function(t){t.put("rzSliderTpl.html",'<div class=rzslider><span class=rz-bar-wrapper><span class=rz-bar></span></span> <span class=rz-bar-wrapper><span class="rz-bar rz-selection" ng-style=barStyle></span></span> <span class="rz-pointer rz-pointer-min" ng-style=minPointerStyle></span> <span class="rz-pointer rz-pointer-max" ng-style=maxPointerStyle></span> <span class="rz-bubble rz-limit rz-floor"></span> <span class="rz-bubble rz-limit rz-ceil"></span> <span class=rz-bubble></span> <span class=rz-bubble></span> <span class=rz-bubble></span><ul ng-show=showTicks class=rz-ticks><li ng-repeat="t in ticks track by $index" class=rz-tick ng-class="{\'rz-selected\': t.selected}" ng-style=t.style ng-attr-uib-tooltip="{{ t.tooltip }}" ng-attr-tooltip-placement={{t.tooltipPlacement}} ng-attr-tooltip-append-to-body="{{ t.tooltip ? true : undefined}}"><span ng-if="t.value != null" class=rz-tick-value ng-attr-uib-tooltip="{{ t.valueTooltip }}" ng-attr-tooltip-placement={{t.valueTooltipPlacement}}>{{ t.value }}</span> <span ng-if="t.legend != null" class=rz-tick-legend>{{ t.legend }}</span></li></ul></div>')}]),e.name}),angular.module("alpacaEditor",["firebase","rzModule","dndLists","ngTagsInput","swiperRepeat","ngAnimate","flow","angularResizable","alpacaViewer","alpacaSchemas","alpacaTypes"]),angular.module("alpacaEditor").filter("toArray",function(){return function(t,e){return angular.isObject(t)?e===!1?Object.keys(t).map(function(e){return t[e]}):Object.keys(t).map(function(e){var i=t[e];return angular.isObject(i)?Object.defineProperty(i,"$key",{enumerable:!1,value:e}):{$key:e,$value:i}}):t}}),angular.module("alpacaEditor").directive("alpacaField",["$compile","$templateRequest",function(t,e){var i=function(i,n,s){e("alpaca-type-"+i.type).then(function(e){var s=angular.element(e);n.after(s),t(s)(i)})};return{restrict:"E",link:i,scope:{model:"=",type:"=",field:"=",fn:"=",slide:"=",templates:"="}}}]),angular.module("alpacaEditor").controller("collectionsController",["$scope",function(t){t.searchValue="",t.surveys=[{title:"Survey1",author:"Haemin Park"},{title:"Survey2",author:"No one"},{title:"Survey3",author:"Poo"},{title:"Survey4",author:"Poo"},{title:"Survey5",author:"Poo"},{title:"Survey6",author:"Poo"},{title:"Survey7",author:"Poo"}]}]),angular.module("alpacaEditor").controller("demoController",["$scope","$templateList","$schemas","$timeout","$firebaseObject","$window",function(t,e,i,n,s,o){var a=firebase.database().ref().child("config");s(a).$bindTo(t,"config"),t.defaultTags=function(){var t=["blah","ahah"];return t},t.templates=e.templates,console.log(e),t.tabs=[{name:"collections",icon:"view_module"},{name:"edit",icon:"mode_edit"},{name:"metadata",icon:"timeline"},{name:"settings",icon:"settings"}],t.tab=t.tabs[0],t.setTab=function(e){t.tab=null,n(function(){t.tab=e},200)},t.survey={slides:[{kind:"slide",title:"Nested Slide 1",content:"How certain are you that your situation will improve?",template:"green",options:[{text:"Uncertain",weight:1,suggestions:["Eat more broccoli","Work out every day"]},{text:"Somewhat uncertain",weight:2},{text:"Unsure",weight:3},{text:"Somewhat certain",weight:4},{text:"Certain",weight:5}]},{kind:"slide",title:"Nested Slide 2",content:"How certain are you that you will achieve your goals you set?",template:"orange",options:[{text:"Uncertain",weight:1},{text:"Somewhat uncertain",weight:2},{text:"Unsure",weight:3},{text:"Somewhat certain",weight:4},{text:"Certain",weight:5}]}],nodes:[{kind:"external",title:"Onboarding",contents:[{kind:"slide",title:"Welcome",content:"Foo",template:"green",readonly:!0},{kind:"slide",title:"Instructions",content:"Fluf",template:"orange",readonly:!0}]},{kind:"slide",title:"Slide 1",content:"Foo",template:"green",options:[{text:"Yes",correct:!0},{text:"No",correct:!1}]},{kind:"slide",title:"Slide 2",content:"Fluf",template:"orange"},{kind:"folder",title:"Smoking",contents:[{kind:"slide",title:"Nested Slide 1",content:"Foo",template:"green"},{kind:"slide",title:"Nested Slide 2",content:"Fluf",template:"orange"}]}]},t.selected=t.survey.nodes[1],t.schemas=i.schemas,t.maximized=!1,t.maximizePreview=function(e){$(".resizable-wrapper").toggleClass("minimized"),t.maximized=!t.maximized},t.devices={iphone:{name:"iPhone",width:480,height:720,material_icon:"smartphone"},desktop:{name:"Desktop",width:1920,height:1080,material_icon:"desktop_windows"},tablet:{name:"iPad",width:1024,height:768,material_icon:"tablet"}},t.setDevice=function(e){t.device=e,console.log("set device:",e)},t.setSlide=function(e){t.selected=e,console.log(e)},t.loading=!1,t.search=function(){t.searching=!0,n(function(){$("#search").focus()})},t.$on("device-ready",function(){t.setDevice(t.devices.tablet),t.loading=!1}),t.fn={tags:{search:function(e){console.log("query",e);var i=[];return angular.forEach(t.config.tags,function(t){t.text.includes(e)&&i.push(t.text)}),i}}}}]),angular.module("alpacaEditor").directive("devicePreview",function(){var t=function(t,e,i){var n=angular.element(e).parent(),s=angular.element(e);s.css({background:"white"}),n.css({display:"flex","align-items":"center","justify-content":"center"}),t.$watch("device",function(){var i=t.device;if(!angular.element(e).parent()[0])return!1;n.width=t.$parent.frame_size.width,n.height=t.$parent.frame_size.height,console.log(t.device);var o=n.width/n.height>i.width/i.height,a=o?n.height/i.height:n.width/i.width,r=o?i.width*n.height/i.height:n.width,l=o?n.height:i.height*n.width/i.width;s.css({transform:"scale("+a+")",width:r/a+"px",height:l/a+"px"});var h={x:Math.max(i.width,r),y:Math.max(i.height,l)},u={x:-1*((h.x-n.width)/2),y:-1*((h.y-n.height)/2)};t.$parent.iframe.css({width:h.x,height:h.y,transform:"translate("+u.x+"px,"+u.y+"px)"}),console.log("device",i.width,i.height),console.log("parent",n.width,n.height),console.log("scale",a),console.log("new",r,l)})};return{restrict:"E",link:t,scope:{device:"="}}}),angular.module("alpacaEditor").directive("wrapInFrame",["$compile","$timeout",function(t,e){return{restrict:"E",scope:{},transclude:!0,replace:!1,link:function(e,i,n,s,o){e.$parent.frame_size={width:i.parent().width(),height:i.parent().height()},o(e.$parent,function(n,s){i.html("<iframe width='100%' height='100%'>");var o=i.find("iframe")[0];e.$parent.iframe=angular.element(o),o.onload=function(){e.$parent.linked=!0;var i=angular.element(o.contentWindow.document.body);$("link[rel='stylesheet'], link[type='text/css'], link[href$='.css']").clone().appendTo($("iframe").contents().find("head")),$('<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>').appendTo($("iframe").contents().find("head")),t(n)(e.$parent,function(t){i.append(t),e.$parent.$emit("device-ready")})},o.src=""})}}}]);
//# sourceMappingURL=alpaca-editor.min.js.map
